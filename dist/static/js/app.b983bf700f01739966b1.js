webpackJsonp([1],{"+b6q":function(t,e){},"/HYw":function(t,e){},"0QAm":function(t,e){},"29EV":function(t,e){},"4zrV":function(t,e){},"5Yl0":function(t,e){},"7tc7":function(t,e){},AYLs:function(t,e){},Bv3T:function(t,e){},CZcV:function(t,e){},Du6h:function(t,e){},JlM0:function(t,e){},MD4w:function(t,e){},MMEr:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),s=a("7+uW"),r={name:"SubPage",props:{title:String}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sub-page"},[a("div",{staticClass:"sub-page-title"},[t._v(t._s(t.title))]),t._v(" "),a("div",{staticClass:"sub-page-content"},[t._t("default",function(){return[t._v("在做了在做了（下次一定）……")]})],2)])},staticRenderFns:[]};var l=a("VU/8")(r,o,!1,function(t){a("aSaL")},"data-v-e5d071e2",null).exports,c=a("mvHQ"),u=a.n(c),d=new s.default,f=a("7t+N"),h=a.n(f),p={name:"eWindow",props:{windowId:String,title:String,width:String,type:String,submit:Function,onClose:Function,beforeClose:Function,fullscreen:Boolean,appendToBody:{type:Boolean,default:!0},enableDrag:{type:Boolean,default:!1},shadeClose:{type:Boolean,default:!0}},watch:{visible:function(t){var e=this;if(!t&&this.onClose&&this.onClose(this.windowId||this.uid()),t&&this.drag){var a="."+this.uid()+" .el-dialog__header";this.$nextTick(function(){h()(a).off().on({mousedown:function(){h()(a).on("mousemove",function(t){e.positions.x+=t.originalEvent.movementX,e.positions.y+=t.originalEvent.movementY})},mouseup:function(){h()(a).off("mousemove")}})})}!this.top&&this.topParents&&this.$nextTick(function(){d.$emit("windowBus"+e.topParents,{uid:e.uid(),status:t})})},positions:{handler:function(){h()("."+this.uid()).css({top:this.positions.y,left:this.positions.x})},deep:!0}},methods:{uid:function(){return"Window"+this._uid},show:function(){this.visible=!0},hide:function(){this.visible=!1},submitAction:function(){this.submit?this.submit():this.hide()},foundParents:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return void 0!==t.$parent?("eWindow"===t.$parent.$options.name&&e.unshift(t.$parent.uid()),this.foundParents(t.$parent,e)):e}},data:function(){return{top:!1,topParents:null,visible:!1,drag:!1,children:[],positions:{x:0,y:0}}},mounted:function(){var t=this,e=this.foundParents();this.drag=!e.length&&(this.enableDrag&&!this.fullscreen),this.topParents=e.length?e[0]:null,this.top=!e.length,this.top&&(this.children.push(this.uid()),d.$on("windowBus"+this.uid(),function(e){var a=t.children,i=a.indexOf(e.uid);e.status?a.push(e.uid):a.splice(i,1);var n=JSON.parse(u()(a)).reverse(),s=0;for(var r in n){var o=h()(".custom-window."+n[r]),l=h()(".custom-window."+n[parseInt(r)-1]),c=l.length?(l.width()-o.width())/2:0,d=o.width()+c+s+20;o.css({transform:"translateX(-"+(r>0?d:0)+"px)",transition:"transform 400ms ease-in-out"}),s+=r>0?d:0}}))}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,width:t.width||"700px",visible:t.visible,fullscreen:t.fullscreen,"append-to-body":t.appendToBody,center:!0,"show-close":!0,"before-close":t.beforeClose,"close-on-click-modal":t.shadeClose,"custom-class":["custom-window",t.uid()].join(" ")},on:{"update:visible":function(e){t.visible=e}}},["form"===t.type?[a("el-form",{staticStyle:{overflow:"hidden"},attrs:{"label-width":"120px",size:"small"}},[t._t("default")],2),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[t._t("button",function(){return[a("el-button",{on:{click:t.hide}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitAction}},[t._v("确定")])]})],2)]:[t._t("default")]],2)},staticRenderFns:[]};var v=a("VU/8")(p,m,!1,function(t){a("baHF")},null,null).exports,g={name:"App",components:{SubPage:l,eWindow:v},methods:{getTitle:function(){var t=this.$route.path,e=!0,a=!1,i=void 0;try{for(var s,r=n()(this.nav.list);!(e=(s=r.next()).done);e=!0){var o=s.value;if(o.path===t)return o.name.toUpperCase()}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}return"None"},handleCommand:function(t){var e=this;switch(t){case"editPassword":this.$refs.editPassword.show();break;case"logout":this.logout();break;case"restart":this.lib.message.confirm("确定重启","注意",function(){e.lib.requests.post({url:"/restart"})})}},editPassword:function(){var t=this;if(this.form.newPassword!==this.form.newPasswordConfirm)return this.lib.message.notify("新密码不一致"),!1;this.lib.requests.post({url:"/editPassword",data:this.form,successMessage:!0,success:function(e){t.$refs.editPassword.hide()}})},logout:function(){var t=this;this.lib.message.confirm("确定退出登录吗？","退出登录",function(){t.lib.requests.post({url:"/logout",success:function(t){location.href="/"}})})},checkClientSize:function(){document.body.clientWidth<1024||document.body.clientHeight<500?this.show=!1:this.show=!0}},data:function(){return{nav:{list:[{path:"/index",name:"消息统计"},{path:"/group",name:"群组管理"},{path:"/user",name:"用户管理"},{path:"/gacha",name:"卡池管理"},{path:"/admin",name:"权限管理"},{path:"/function",name:"功能选项"},{path:"/source",name:"资源管理"}]},form:{password:"",newPassword:"",newPasswordConfirm:""},icp:window.icp,show:!1}},mounted:function(){window.onresize=this.checkClientSize,this.checkClientSize()}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t.show?["/"!==t.$route.path?[a("div",{staticClass:"main-header"},[a("div",{staticClass:"title"},[t._v("Amiya-bot Console")]),t._v(" "),a("div",{staticClass:"nav"},t._l(t.nav.list,function(e){return a("div",{key:e.path,class:{curr:e.path===t.$route.path},on:{click:function(a){return t.$router.push(e.path)}}},[a("span",[t._v(t._s(e.name))])])}),0),t._v(" "),a("div",{staticClass:"user-menu"},[a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"user"},[t._v("BOT选项"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"restart"}},[t._v("重启BOT")])],1)],1),t._v(" "),a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"user"},[t._v("个人选项"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"editPassword"}},[t._v("修改密码")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出登录")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"main-body"},[a("SubPage",{attrs:{title:t.getTitle()}},[a("router-view")],1)],1),t._v(" "),a("div",{staticClass:"icp"},[a("a",{attrs:{href:"https://beian.miit.gov.cn",target:"_blank"}},[t._v(t._s(t.icp))])]),t._v(" "),a("e-window",{ref:"editPassword",attrs:{title:"修改密码",type:"form",submit:t.editPassword}},[a("el-form-item",{attrs:{label:"原密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.newPassword,callback:function(e){t.$set(t.form,"newPassword",e)},expression:"form.newPassword"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"确认新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.newPasswordConfirm,callback:function(e){t.$set(t.form,"newPasswordConfirm",e)},expression:"form.newPasswordConfirm"}})],1)],1)]:a("div",{staticClass:"content"},[a("router-view")],1)]:[t._m(0)]],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tips"},[e("div",[this._v("分辨率太低啦…")]),this._v(" "),e("div",[this._v("请至少使用 "),e("span",{staticStyle:{color:"#7350ff","font-weight":"bold"}},[this._v("1024 X 500")]),this._v(" 的窗口使用哦")])])}]};var _=a("VU/8")(g,b,!1,function(t){a("mQtQ"),a("4zrV")},"data-v-7cd72d02",null).exports,y=a("/ocq"),w={name:"Login",methods:{login:function(){var t=this;this.form.userId&&this.form.password&&this.lib.requests.post({url:"/login",data:this.form,successMessage:!0,success:function(e){t.$router.push("/index")},error:function(){t.currStatus=4}})},toBotGitHub:function(){window.open("https://github.com/vivien8261/Amiya-Bot")},toConsoleGitHub:function(){window.open("https://github.com/vivien8261/Amiya-Bot-console")}},data:function(){return{form:{userId:"",password:""},status:{1:"normal",2:"account",3:"password",4:"error"},currStatus:1,icp:window.icp}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("div",{staticClass:"rabbit"}),t._v(" "),a("div",{staticClass:"login-form"},[a("div",{staticClass:"github",on:{click:t.toConsoleGitHub}}),t._v(" "),a("div",{staticClass:"face",class:t.status[t.currStatus]}),t._v(" "),a("div",{staticClass:"logo"},[a("div",{staticClass:"text"},[t._v("Login")]),t._v(" "),a("div",{staticClass:"text bot",on:{click:t.toBotGitHub}},[t._v("Amiya-Bot")]),t._v(" "),a("div",{staticClass:"text"},[t._v("Console")])]),t._v(" "),a("div",{staticClass:"form"},[a("div",{staticClass:"form-title"},[t._v("UserID")]),t._v(" "),a("div",[a("el-input",{attrs:{size:"small",placeholder:"请输入用户ID","prefix-icon":"el-icon-user"},on:{focus:function(e){t.currStatus=2},blur:function(e){t.currStatus=1},change:t.login},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),t._v(" "),a("div",{staticClass:"form-title"},[t._v("Password")]),t._v(" "),a("div",[a("el-input",{attrs:{size:"small",type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-key"},on:{focus:function(e){t.currStatus=3},blur:function(e){t.currStatus=1},change:t.login},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("div",{staticClass:"form-button"},[a("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("Link Start !")])],1)])]),t._v(" "),a("div",{staticClass:"icp"},[a("a",{attrs:{href:"https://beian.miit.gov.cn",target:"_blank"}},[t._v(t._s(t.icp))])])])},staticRenderFns:[]};var x=a("VU/8")(w,k,!1,function(t){a("V47x")},"data-v-2ac23b54",null).exports,S={name:"NumberCard",props:{title:String,value:String|Number,color:String}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"number-card",style:{backgroundColor:"#"+this.color}},[e("div",{staticClass:"value"},[this._v(this._s(this.value))]),this._v(" "),e("div",{staticClass:"title"},[this._t("default")],2)])},staticRenderFns:[]};var $=a("VU/8")(S,C,!1,function(t){a("uCiw")},"data-v-059e64bb",null).exports,D=a("XLwt"),F={name:"UserSignIn",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={grid:{top:"3%",left:"3%",right:"12%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"value",splitLine:{show:!1}},yAxis:{type:"category",axisLabel:{color:"#333",fontWeight:"bold"},data:["签到用户"]},color:["#56d47d","#d7d7d7"],series:[{name:"已签到",type:"bar",stack:"count",data:[]},{name:"未签到",type:"bar",stack:"count",label:{show:!0,position:"right",formatter:"30%"},data:[]}]},e=this.data;t.series[0].data=[e[1]],t.series[1].data=[e[0]-e[1]],t.series[1].label.formatter=(e[1]/e[0]*100).toFixed(2)+"%",this.chart.setOption(t)},getUserSignData:function(){var t=this;this.lib.requests.post({url:"/dashboard/getUserSignRate",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:{0:0,1:0}}},mounted:function(){this.chart=D.b(this.$refs.chart),this.getUserSignData()}},P={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user-sign-in"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var A=a("VU/8")(F,P,!1,function(t){a("MMEr")},"data-v-8d477bda",null).exports,I={name:"MessageCount",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={title:{text:"消息数量分析"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},legend:{data:["群聊","主动呼叫","回复"]},axisPointer:{link:{xAxisIndex:"all"}},grid:[{left:"10%",right:"4%",height:"35%"},{top:"60%",left:"10%",right:"4%",height:"35%"}],xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!0},axisLabel:{show:!1},data:[]},{gridIndex:1,type:"category",boundaryGap:!1,axisLine:{onZero:!0},data:[],position:"top"}],yAxis:[{type:"value",offset:15},{type:"value",inverse:!0,gridIndex:1,offset:15}],color:["#5f75ed","#ffba31","#56d47d"],series:[{name:"群聊",type:"line",areaStyle:{opacity:.8,color:new D.a.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 221, 255)"},{offset:1,color:"rgba(77, 119, 255)"}])},label:{show:!0},data:[],smooth:!0},{name:"主动呼叫",type:"bar",barMaxWidth:10,stack:"count",xAxisIndex:1,yAxisIndex:1,data:[],smooth:!0},{name:"回复",type:"bar",barMaxWidth:10,stack:"count",xAxisIndex:1,yAxisIndex:1,label:{show:!0,position:"bottom"},data:[],smooth:!0}]},e=this.data;for(var a in e)t.xAxis[0].data.unshift(a),t.xAxis[1].data.unshift(a),t.series[0].data.unshift(e[a].talk),t.series[1].data.unshift(e[a].call),t.series[2].data.unshift(e[a].reply);this.chart.setOption(t)},getMessageAnalysis:function(){var t=this;this.lib.requests.post({url:"/dashboard/getMessageAnalysis",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:null}},mounted:function(){this.chart=D.b(this.$refs.chart),this.getMessageAnalysis()}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message-count"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var L=a("VU/8")(I,T,!1,function(t){a("hAhP")},"data-v-8667d36e",null).exports,O={normal:"普通互动",userInfo:"查看个人信息",checkOperator:"干员资料",checkEnemy:"敌方单位资料",checkMaterial:"物品资料",recruit:"公招查询",gacha:"模拟抽卡",jadeCalculator:"合成玉计算",intellectAlarm:"理智恢复提醒",functionQuery:"查看菜单",weibo:"微博",replaceText:"词语替换"},U={globalState:function(){var t={};for(var e in O)t[e]=!0;return t}(),weiboSetting:{weiboSendGIF:!0,weiboAutoPush:!0,checkRate:30},jadeSetting:{signIn:0,dailyTasks:0,weeklyTasks:0,weeklyBattle:0}},M={name:"FunctionCount",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={title:{text:"功能使用总量",subtext:"不含普通互动"},legend:{type:"scroll",orient:"vertical",top:60,left:0,bottom:20},tooltip:{trigger:"item"},series:{type:"pie",radius:["50%","80%"],center:["65%","50%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,fontSize:"20",fontWeight:"bold",position:"center",formatter:"{b}\n\n{c}"},minAngle:10,data:[]}},e=this.data,a=!0,i=!1,s=void 0;try{for(var r,o=n()(e);!(a=(r=o.next()).done);a=!0){var l=r.value;t.series.data.push({name:O[l.function_id]||"未知",value:l.use_num})}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}t.series.data.sort(function(t,e){return e.value-t.value}),t.series.data[0].selected=!0,t.series.data[0].label={show:!0},this.chart.setOption(t)},getFunctionUsed:function(){var t=this;this.lib.requests.post({url:"/dashboard/getFunctionUsed",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:null}},mounted:function(){this.chart=D.b(this.$refs.chart),this.getFunctionUsed()}},B={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"function-count"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var V={name:"Dashboard",components:{NumberCard:$,UserSignIn:A,MessageCount:L,FunctionCount:a("VU/8")(M,B,!1,function(t){a("Du6h")},"data-v-5bf2f104",null).exports},methods:{getTotalMessage:function(){var t=this;this.lib.requests.post({url:"/dashboard/getTotalMessage",success:function(e){t.cards.reply=e}})},getMessageSpeed:function(){var t=this;this.lib.requests.post({url:"/dashboard/getMessageSpeed",success:function(e){t.cards.speed=e}})},getActiveUsers:function(){var t=this;this.lib.requests.post({url:"/dashboard/getActiveUsers",success:function(e){t.cards.activeUsers=e}})}},data:function(){return{cards:{reply:0,activeUsers:0,speed:0}}},mounted:function(){this.getTotalMessage(),this.getMessageSpeed(),this.getActiveUsers()}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard"},[a("div",{staticClass:"information"},[a("number-card",{attrs:{value:t.cards.reply,color:"5f75ed"}},[[a("span",[t._v("24小时内")]),t._v(" "),a("span",[t._v("总回复次数")])]],2),t._v(" "),a("number-card",{attrs:{value:t.cards.activeUsers,color:"ff7ea8"}},[[a("span",[t._v("24小时内")]),t._v(" "),a("span",[t._v("活跃用户总数")])]],2),t._v(" "),a("number-card",{attrs:{value:t.cards.speed+"/min",color:"56d47d"}},[[a("span",[t._v("实时")]),t._v(" "),a("span",[t._v("消息接收速度")])]],2)],1),t._v(" "),a("div",{staticClass:"charts"},[a("div",{staticClass:"left-side"},[a("message-count"),t._v(" "),a("div",{staticClass:"seat seat-left-row2"})],1),t._v(" "),a("div",{staticClass:"right-side"},[a("function-count"),t._v(" "),a("user-sign-in")],1)])])},staticRenderFns:[]};var E=a("VU/8")(V,R,!1,function(t){a("u66W")},"data-v-5b4efab0",null).exports,z=a("woOf"),q=a.n(z),N=a("fZjL"),W=a.n(N),H={size:{type:String,default:"medium"},inline:{type:Boolean,default:!1},labelWidth:{type:String,default:"150px"},buildData:{type:Array,default:function(){return[]}},displayFilter:{type:Array,default:function(){return[]}},displayAll:{type:Boolean,default:!0},beforeSubmit:{type:Function,default:function(){return null}},onchange:{type:Function,default:function(){return null}}},j={bind:Object,field:String,virtual:Object,setVirtual:Function,tree:{type:Object,default:function(){return{}}},treeData:{type:Array,default:function(){return[]}},selected:{type:Function,default:function(){}}},G={name:"eCheckboxTree",props:{data:Array,nodeKey:{type:String,default:"id"},label:{type:String,default:"label"},children:{type:String,default:"children"},nodeClick:{type:Function,default:function(t){return null}},height:{type:String,default:"500px"},expandAll:{type:Boolean,default:!0},checkbox:{type:Boolean,default:!1},expandOnClickNode:{type:Boolean,default:!0}},watch:{filterText:function(t){this.$refs.tree.filter(t)}},methods:{getCheckedNodes:function(){return this.$refs.tree.getCheckedNodes()},getCheckedKeys:function(){return this.$refs.tree.getCheckedKeys()},setCheckedKeys:function(t){this.$refs.tree.setCheckedKeys(t)},filterNode:function(t,e){return!t||-1!==e[this.label].indexOf(t)}},data:function(){return{defaultProps:{label:this.label,children:this.children},filterText:""}}},J={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{height:t.height}},[a("el-form",{attrs:{size:"small","label-width":"0"}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("el-input",{attrs:{placeholder:"输入关键字搜索"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1)],1),t._v(" "),a("div",{staticClass:"treeCon"},[a("el-tree",{ref:"tree",attrs:{"highlight-current":"",data:t.data,"node-key":t.nodeKey,props:t.defaultProps,"show-checkbox":t.checkbox,"default-expand-all":t.expandAll,"expand-on-click-node":!1,"filter-node-method":t.filterNode},on:{"node-click":t.nodeClick}})],1)],1)},staticRenderFns:[]};var Y={name:"treeSelector",props:j,components:{eCheckboxTree:a("VU/8")(G,J,!1,function(t){a("wxIg")},"data-v-50f9789a",null).exports},watch:{status:{handler:function(t){this.visible=t.onFocus||t.onHover},deep:!0},dataList:{handler:function(t){this.$emit("dataChange",t)},deep:!0}},methods:{uid:function(){return"treeSelector"+this._uid},show:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments[1];this.minWidth=e.target.clientWidth,this.status.onFocus=t},nodeSelected:function(t){if(t){if(this.field in t){var e=t[this.virtual&&"value"in this.virtual?this.virtual.value:this.field],a=t[this.virtual&&"show"in this.virtual?this.virtual.show:this.field];this.bind[this.field]=a||e,this.setVirtual(this.field,e)}this.selected&&this.selected(JSON.parse(u()(t)))}this.status.onHover=!1}},data:function(){return{visible:!1,status:{onFocus:!1,onHover:!1},minWidth:0}},mounted:function(){var t=this;h()("."+this.uid()).off("mouseenter mouseleave").on({mouseenter:function(){return t.status.onHover=!0},mouseleave:function(){return t.status.onHover=!1}})}},Q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tree-selector"},[a("el-popover",{attrs:{placement:"bottom",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},[t._t("default",null,{show:t.show})],2),t._v(" "),a("div",{staticClass:"tree-content",class:t.uid(),style:{minWidth:t.minWidth+"px"}},[a("e-checkbox-tree",{attrs:{data:t.treeData,"node-key":t.tree.id,label:t.tree.label,children:t.tree.children,"node-click":t.nodeSelected,"expand-on-click-node":!1,checkbox:!1}})],1)])],1)},staticRenderFns:[]};var Z=a("VU/8")(Y,Q,!1,function(t){a("QF50")},"data-v-70d96b5c",null).exports,K={name:"tableSelector",props:{tableData:Array,tableField:Array,search:Function,inputValue:String,bind:Object,field:String,virtual:Object,setVirtual:Function,selected:{type:Function,default:function(){}}},watch:{inputValue:function(t){t?this.doSearch(t):(this.$set(this,"dataList",[]),this.$emit("inputEmpty"))},status:{handler:function(t){this.visible=t.onFocus||t.onHover},deep:!0},tableData:{handler:function(){this.loadData()},deep:!0},dataList:{handler:function(t){var e=this;this.$nextTick(function(){e.$emit("dataChange",t)})},deep:!0},visible:function(t){var e=this;t?(this.doSearch(this.inputValue||void 0),h()(".search-table."+this.uid()).off("mouseenter mouseleave").on({mouseenter:function(){return e.status.onHover=!0},mouseleave:function(){return e.status.onHover=!1}})):h()(".search-table."+this.uid()).off("mouseenter mouseleave")},currIndex:function(t){var e=(t-6)*h()(".search-table."+this.uid()+" .curr").height();h()(".search-table."+this.uid()+" .el-table__body-wrapper").scrollTop(e)}},methods:{uid:function(){return"tableSelector"+this._uid},onInput:function(){this.setVirtual(this.field,"")},doSearch:function(t){var e=this;this.search&&this.search(t,function(t){e.$set(e,"dataList",t)})},show:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=arguments[1];this.minWidth=a.target.clientWidth,this.status.onFocus=e,e&&(this.currIndex=0,h()(a.target).off("keydown").on({keydown:function(e){switch(e.keyCode){case 13:t.dataList.length&&(t.selectedRow(t.dataList[t.currIndex]),t.status.onFocus=!1,a.target.blur());break;case 38:t.currIndex=t.currIndex-1>-1?t.currIndex-1:0;break;case 40:t.currIndex=t.currIndex+1<t.dataList.length?t.currIndex+1:t.dataList.length-1}}}))},hoverRow:function(t){return t.rowIndex===this.currIndex?"curr":""},selectedRow:function(t){if(t){if(this.field in t){var e=t[this.virtual&&"value"in this.virtual?this.virtual.value:this.field],a=t[this.virtual&&"show"in this.virtual?this.virtual.show:this.field];this.bind[this.field]=a||e,this.setVirtual(this.field,e)}this.selected&&this.selected(JSON.parse(u()(t)))}this.status.onHover=!1},loadData:function(){this.$set(this,"dataList",this.tableData||[])}},data:function(){return{visible:!1,status:{onFocus:!1,onHover:!1},dataList:[],colWidth:{},minWidth:0,currIndex:0}},mounted:function(){this.loadData()}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-selector"},[a("el-popover",{attrs:{placement:"bottom",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},[t._t("default",null,{show:t.show,input:t.onInput})],2),t._v(" "),a("div",{staticClass:"search-table",class:t.uid(),style:{minWidth:t.minWidth+"px"}},[a("el-table",{ref:"table",attrs:{data:t.dataList,"row-class-name":t.hoverRow,"max-height":"303px",border:"","highlight-current-row":""},on:{"current-change":t.selectedRow}},t._l(t.tableField,function(e,i){return a("el-table-column",{key:i,attrs:{"class-name":"mark_"+e.field,width:(t.colWidth[e.field]||0)+"px",prop:e.field,label:e.title}})}),1)],1)])],1)},staticRenderFns:[]};var tt={name:"formBuilder",props:H,components:{treeSelector:Z,tableSelector:a("VU/8")(K,X,!1,function(t){a("5Yl0"),a("ny9V")},null,null).exports},watch:{datePicker:{handler:function(){for(var t in this.datePicker){var e=this.datePicker[t];Array.isArray(e)?(this.formData[t][0]=e[0]?Math.ceil(new Date(e[0])/1e3):0,this.formData[t][1]=e[0]?Math.ceil(new Date(e[1])/1e3):0):this.formData[t]=e?Math.ceil(new Date(e)/1e3):0}},deep:!0}},methods:{uid:function(){return"formBuilder"+this._uid},init:function(){var t=this,e={},a={},i={},s={},r={},o={},l={},c={selected:{},change:{},input:{}},u=function(u){var d=t.buildData[u];if(!t.displayAll&&t.displayFilter.indexOf(d.title)<0&&t.displayFilter.indexOf(d.field)<0)return"continue";var f=function(){d.config.lazy?(r[d.field]=[31,32].indexOf(h)>=0?[]:{},d.config.data(function(t){return r[d.field]=t})):r[d.field]=d.config.data},h=d.config.type,p=d.config.default;d.field in t.formData&&void 0!==t.formData[d.field]&&""!==t.formData[d.field]&&(p=t.formData[d.field]);var m=1===h?"blur":"change";e[d.field]=[],d.config.required&&e[d.field].push({required:!0,message:d.title+"不能为空",trigger:m}),d.config.rule&&e[d.field].push({validator:function(t,e,a){var i=d.config.rule(e);if(i)return a(new Error(i)),!1;a()},trigger:m});var v=!!d.config.disabled;if(d.field in t.disabledItem&&t.disabledItem[d.field]&&(v=!0),l[d.field]=v,d.config.virtual&&(o[d.field]=(d.field in t.virtualData?t.virtualData[d.field]:p)||""),d.config.event){var g=!0,b=!1,_=void 0;try{for(var y,w=n()(W()(c));!(g=(y=w.next()).done);g=!0){var k=y.value;k in d.config.event&&(c[k][d.field]=d.config.event[k])}}catch(t){b=!0,_=t}finally{try{!g&&w.return&&w.return()}finally{if(b)throw _}}}switch(h){case 1:case 2:d.config.disabled||(a[u]={field:d.field,rule:d.config.rule,required:d.config.required}),i[d.field]=p||"";break;case 3:f(),d.config.multiple?i[d.field]=(p||[]).map(function(t){return t.toString()}):i[d.field]=(p||"").toString();break;case 31:case 32:f(),i[d.field]=p||"";break;case 4:case 41:s[d.field]=p?t.newData(p):"",i[d.field]=p||0;break;case 5:case 51:s[d.field]=p?[t.newData(p[0]),t.newData(p[1])]:["",""],i[d.field]=p||[0,0];break;case 6:case 7:f(),i[d.field]=7===h?(p||[]).map(function(t){return t.toString()}):(p||"").toString();break;case 8:i[d.field]=p||!1}};for(var d in this.buildData)u(d);this.$set(this,"rules",e),this.$set(this,"jumps",a),this.$set(this,"events",c),this.$set(this,"formData",i),this.$set(this,"datePicker",s),this.$set(this,"optionsData",r),this.$set(this,"virtualData",o),this.$set(this,"disabledItem",l),this.$nextTick(function(){h()("."+t.uid()+" .input-only").off("keydown").keydown(function(e){if(13===e.keyCode){var a=parseInt(h()(e.target).closest(".input-only")[0].className.match(/input-index-(\d+)/)[1]);t.autoJump(a)}}),t.reviewOptions()})},autoJump:function(t){var e=this.jumps[t],a=this.formData[e.field];if(""===a&&e.required)return!1;if(e.rule&&e.rule(a))return this.$refs[e.field][0].select(),!1;var i=W()(this.jumps).map(function(t){return parseInt(t)}),n=i[i.indexOf(t)+1],s=this.jumps[n];s?this.$refs[s.field][0].focus():this.beforeSubmit(this.formData)},formChange:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"change";t in this.events[a]&&this.events[a][t](JSON.parse(u()(e))),this.changeEvent()},setValue:function(t,e){var a=this;if(t.constructor===Object){for(var i in t)this.setValue(i,t[i]);return!1}var n=function(){t in a.virtualData?a.virtualData[t]=e:a.formData[t]=e};for(var s in this.buildData){var r=this.buildData[s];if(t===r.field){switch(r.config.type){case 3:e=Array.isArray(e)?e.map(function(t){return t.toString()}):e.toString(),n();break;case 31:n(),this.$refs["tableSelector"+s][0].doSearch(e);continue;case 4:case 41:this.datePicker[r.field]=e?this.newData(e):"";break;case 5:case 51:this.datePicker[r.field]=e?[this.newData(e[0]),this.newData(e[1])]:["",""];break;default:n()}this.reviewOptions(t);break}}this.changeEvent()},setOptions:function(t,e){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.$set(this.optionsData,t,e),a&&this.reviewOptions(t)},setDisabled:function(t,e){this.$set(this.disabledItem,t,e)},setVirtual:function(t,e){t in this.virtualData&&this.$set(this.virtualData,t,e)},reviewOptions:function(t){var e=this,a=function t(a,i){for(var n in a){var s=a[n];if(s[i.config.virtual.value||i.field]===e.virtualData[i.field])return e.formData[i.field]=s[i.config.virtual.show],!0;if("children"in s&&Array.isArray(s.children)&&s.children.length)if(t(s.children,i))return!0}},i=!0,s=!1,r=void 0;try{for(var o,l=n()(this.buildData);!(i=(o=l.next()).done);i=!0){var c=o.value,u=this.optionsData[c.field];u&&c.field in this.optionsData&&c.field in this.virtualData&&c.config.virtual&&"show"in c.config.virtual&&(!t||c.field===t)&&a(u,c)}}catch(t){s=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(s)throw r}}},newData:function(t){return new Date(t*(t.toString().length<13?1e3:1))},cleanForm:function(t){var e=!0,a=!1,i=void 0;try{for(var s,r=n()(this.buildData);!(e=(s=r.next()).done);e=!0){var o=s.value;if(!t||t===o.field)switch(o.field in this.virtualData&&(this.virtualData[o.field]=""),o.config.type){case 3:o.config.multiple?this.formData[o.field]=[]:this.formData[o.field]="";break;case 4:case 41:this.datePicker[o.field]="";break;case 5:case 51:this.datePicker[o.field]=["",""];break;case 6:case 7:7===o.config.type?this.formData[o.field]=[]:this.formData[o.field]="";break;case 8:this.formData[o.field]=!1;break;default:this.formData[o.field]=""}}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}this.changeEvent()},changeEvent:function(){this.onchange(JSON.parse(u()(this.formData)))}},data:function(){return{rules:{},jumps:[],formData:{},datePicker:{},optionsData:{},virtualData:{},disabledItem:{},datePickerType:{4:"date",41:"datetime",5:"daterange",51:"datetimerange"},events:{selected:{},change:{},input:{}}}}},et={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.uid()},[a("el-form",{staticClass:"formBuilder",attrs:{model:t.formData,rules:t.rules,size:t.size,inline:t.inline}},[t._l(t.buildData,function(e,i){return t.displayAll||t.displayFilter.indexOf(e.title)>=0||t.displayFilter.indexOf(e.field)>=0?a("el-form-item",{key:e.field,style:{display:e.config.block?"block":""},attrs:{prop:e.field,label:e.title,"label-width":t.labelWidth}},[1==e.config.type?a("el-input",{ref:e.field,refInFor:!0,staticClass:"input-only",class:"input-index-"+i,attrs:{placeholder:"请输入"+e.title,disabled:t.disabledItem[e.field],"suffix-icon":e.config.disabled?"el-icon-remove-outline":"el-icon-edit"},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])},input:function(a){return t.formChange(e.field,t.formData[e.field],"input")}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}}):t._e(),t._v(" "),2==e.config.type?a("el-input-number",{ref:e.field,refInFor:!0,staticClass:"input-only",class:"input-index-"+i,attrs:{placeholder:"请输入"+e.title,disabled:t.disabledItem[e.field],"controls-position":"right"},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])},input:function(a){return t.formChange(e.field,t.formData[e.field],"input")}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}}):t._e(),t._v(" "),3==e.config.type?a("el-select",{attrs:{clearable:"",multiple:e.config.multiple,"allow-create":e.config.create,filterable:e.config.create,"default-first-option":e.config.create,placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field]},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})}),1):t._e(),t._v(" "),31==e.config.type?a("table-selector",{ref:"tableSelector"+i,refInFor:!0,attrs:{"table-data":t.optionsData[e.field],"table-field":e.config.table.fields,search:e.config.table.search,"input-value":t.formData[e.field],virtual:e.config.virtual,field:e.field,bind:t.formData,selected:t.events.selected[e.field],setVirtual:t.setVirtual},on:{dataChange:function(a){return t.setOptions(e.field,a,!0)},inputEmpty:function(){return t.cleanForm(e.field)}},scopedSlots:t._u([{key:"default",fn:function(i){return[a("el-input",{ref:e.field,refInFor:!0,attrs:{placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field],readonly:"function"!=typeof e.config.table.search,"suffix-icon":"el-icon-caret-bottom"},on:{input:i.input,focus:function(t){return i.show(!0,t)},blur:function(t){return i.show(!1,t)},change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]}}],null,!0)}):t._e(),t._v(" "),32==e.config.type?a("tree-selector",{attrs:{tree:e.config.tree,"tree-data":t.optionsData[e.field],virtual:e.config.virtual,field:e.field,bind:t.formData,selected:t.events.selected[e.field],setVirtual:t.setVirtual},on:{dataChange:function(a){return t.setOptions(e.field,a,!0)}},scopedSlots:t._u([{key:"default",fn:function(i){return[a("el-input",{ref:e.field,refInFor:!0,staticClass:"tree-selector",attrs:{readonly:"",placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field],"suffix-icon":"el-icon-caret-bottom"},on:{focus:function(t){return i.show(!0,t)},blur:function(t){return i.show(!1,t)},change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}})]}}],null,!0)}):t._e(),t._v(" "),e.config.type in t.datePickerType?a("el-date-picker",{attrs:{type:t.datePickerType[e.config.type],disabled:t.disabledItem[e.field],"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"请选择日期"},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.datePicker[e.field],callback:function(a){t.$set(t.datePicker,e.field,a)},expression:"datePicker[item.field]"}}):t._e(),t._v(" "),6==e.config.type?a("el-radio-group",{attrs:{disabled:t.disabledItem[e.field]},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(e,i){return a("el-radio",{key:i,attrs:{label:i}},[t._v(t._s(e)+"\n                ")])}),1):t._e(),t._v(" "),7==e.config.type?a("el-checkbox-group",{attrs:{disabled:t.disabledItem[e.field]},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(e,i){return a("el-checkbox",{key:i,attrs:{label:i}},[t._v(t._s(e)+"\n                ")])}),1):t._e(),t._v(" "),8==e.config.type?a("el-switch",{attrs:{disabled:t.disabledItem[e.field],"active-color":"#5F75ED"},on:{change:function(a){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(a){t.$set(t.formData,e.field,a)},expression:"formData[item.field]"}}):t._e(),t._v(" "),e.config.tips?a("el-tooltip",{attrs:{content:e.config.tips,effect:"dark",placement:"top"}},[a("span",{staticClass:"el-icon-question"})]):t._e()],1):t._e()}),t._v(" "),a("el-form-item",{staticStyle:{display:"none"}},[a("el-input")],1)],2)],1)},staticRenderFns:[]};var at=a("VU/8")(tt,et,!1,function(t){a("mxPJ"),a("+b6q")},"data-v-a0d9a3fa",null).exports,it={name:"searchFormBuilder",components:{formBuilder:at},props:{searchForm:Array,searchFormDisplay:Array,searchOn:null|Boolean},watch:{searchOn:function(){this.calcSearchAreaHeight()},searchFormDisplay:function(){var t=this;this.$nextTick(function(){t.$refs.form.init(),t.calcSearchAreaHeight()})}},methods:{uid:function(){return"searchFormBuilder"+this._uid},calcSearchAreaHeight:function(){var t=this;setTimeout(function(){var e=h()("."+t.uid()+" "+(t.searchOn?".form":".searchData")).height();t.$emit("height",e),h()("."+t.uid()+".searchForm").css({height:e,padding:t.searchFormDisplay.length?"5px 0 10px":"0"})},0)},showText:function(t,e){var a=this.lib.common.formatDate,i=this.$refs.form.formData[t.field],n=t.config.type,s=t.field;if(s in this.$refs.form.formData){if(e)switch(n){case 3:return this.$refs.form.optionsData[s][i];case 4:case 41:return 3===n?a(i,"y-m-d"):a(i);case 5:case 51:return i.map(function(t){return 5===n?a(t,"y-m-d"):a(t)}).join(" 至 ");default:return i}switch(n){case 5:case 51:return!!i[0]&&!!i[1];default:return!!i}}return""},delSearch:function(t){this.$refs.form.cleanForm(t)},cleanForm:function(){this.$refs.form.cleanForm(),this.calcSearchAreaHeight()}}},nt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"searchForm",class:t.uid()},[a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.searchOn,expression:"searchOn"}],key:"1",staticClass:"form"},[a("formBuilder",{ref:"form",attrs:{size:"mini","label-width":"100px",inline:!0,"build-data":t.searchForm,"display-all":!1,"display-filter":t.searchFormDisplay}})],1)]),t._v(" "),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.searchOn&&null!=t.searchOn,expression:"!searchOn && searchOn != null"}],key:"2",staticClass:"searchData"},[a("el-alert",{attrs:{title:"搜索内容",type:"info",closable:!1}},t._l(t.searchForm,function(e,i){return t.showText(e,0)?a("div",{key:i,staticClass:"dataItem"},[a("span",[t._v(t._s(e.title))]),t._v(" "),a("span",[t._v(t._s(t.showText(e,1)))]),t._v(" "),a("span",{staticClass:"searchClose",on:{click:function(a){return t.delSearch(e.field)}}})]):t._e()}),0)],1)])],1)},staticRenderFns:[]};var st=a("VU/8")(it,nt,!1,function(t){a("qQ8M"),a("e29U")},"data-v-e8acccb2",null).exports,rt={name:"exportContent",props:["exportPageUrl","exportAllUrl","currPage","currPageSize","getValue"],methods:{exportData:function(t){var e=this.getValue();t&&(e.pageNum=this.currPage,e.pageSize=this.currPageSize),this.lib.requests.export({url:t?this.exportPageUrl:this.exportAllUrl,data:e},void 0,"xlsx")}}},ot={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"operations"},[a("el-button",{attrs:{size:"mini",type:"primary",plain:"",disabled:!t.exportPageUrl},on:{click:function(e){return t.exportData(!0)}}},[t._v("导出当前页\n    ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",plain:"",disabled:!t.exportAllUrl},on:{click:function(e){return t.exportData(!1)}}},[t._v("导出全部\n    ")])],1)},staticRenderFns:[]};var lt=a("VU/8")(rt,ot,!1,function(t){a("TE5g")},"data-v-5d3763a1",null).exports;var ct={name:"eTable",props:{fields:Array,dataId:String,totalPage:Number,exportPageUrl:String,exportAllUrl:String,operationMode:{type:Boolean,default:!0},selection:{type:Boolean,default:!0},pageSize:{type:Number,default:10},data:{type:Array,default:[]},expandAll:{type:Boolean,default:!1},autoReset:{type:Boolean,default:!0},pagination:{type:Boolean,default:!0},listLoader:{type:Function,default:function(){return null}},expandLoader:{type:Function,default:function(){return null}}},components:{searchFormBuilder:st,exportContent:lt},computed:{tableChange:function(){return{data:this.data,display:this.display}}},watch:{tableChange:{handler:function(){this.resetWidth()},deep:!0}},methods:{uid:function(){return"table"+this._uid},rebuild:function(){var t=this;this.$nextTick(function(){var e=[],a=[],i=!0,s=!1,r=void 0;try{for(var o,l=n()(t.fields);!(i=(o=l.next()).done);i=!0){var c=o.value;e.push(c.title)}}catch(t){s=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(s)throw r}}var u=!0,d=!1,f=void 0;try{for(var h,p=n()(t.display);!(u=(h=p.next()).done);u=!0){var m=h.value;e.indexOf(m)>=0&&a.push(m)}}catch(t){d=!0,f=t}finally{try{!u&&p.return&&p.return()}finally{if(d)throw f}}t.$set(t,"display",a),t.initSearchForm()})},getValue:function(){return this.$refs.searchForm.$refs.form.formData},setOptions:function(t,e){this.$refs.searchForm.$refs.form.setOptions(t,e)},searchList:function(){this.currPage=1,this.loadList()},loadList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getValue();q()(t,JSON.parse(u()(e))),this.sort&&(t._sort=this.sort),this.listLoader(this.currPage,this.currPageSize,t)},loadChildren:function(t,e,a){var i=this;this.expandLoader(t,function(t){a(t),i.resetWidth()})},calcTableHeight:function(t){var e=this.$refs.listTable.clientHeight-t-92;e>100&&this.operationMode&&(this.tableHeight=e)},resetWidth:function(){var t=this;this.autoReset&&(this.loading=!0,setTimeout(function(){t.$set(t,"colWidth",function(t){var e={},a={};t.querySelectorAll("tr").forEach(function(t){t.querySelectorAll("td, th").forEach(function(t,i){var n=t.querySelector(".cell");if(n){var s=t.className.match(/mark_(\S+)/)[1],r=n.clientWidth<=400?n.clientWidth:400;s in e&&!(e[s]<r)||(e[s]=r),i in a&&!(a[i]<r)||(a[i]=r)}})});var i=0,n=t.clientWidth;for(var s in a)i+=a[s];return i<n?"operation"in e?{operation:e.operation}:{}:e}(t.$refs.table.$el)),t.$nextTick(function(){t.loading=!1})},300))},pageChange:function(t){this.currPage=t,this.loadList()},pageSizeChange:function(t){this.currPageSize=t,this.loadList()},selectionChange:function(t){this.$set(this,"selectedItems",t)},sortableHandler:function(t){var e=t.prop,a=t.order;this.$set(this,"sort",{field:e,order:a}),this.loadList()},initSearchForm:function(){var t=[],e=[],a=!0,i=!1,s=void 0;try{for(var r,o=n()(this.fields);!(a=(r=o.next()).done);a=!0){var l=r.value,c=l.search,u={title:l.title,field:l.field};!1!==c&&(u.config=c||{type:1},c&&!c.type&&(u.config.type=1),c&&"checked"in c&&c.checked&&e.push(l.title),t.push(u))}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}this.$set(this,"searchForm",t),this.$set(this,"searchFormDisplay",e),this.searchOn=!0},cleanForm:function(){this.$refs.searchForm.cleanForm(),this.loadList()}},data:function(){return{display:[],colWidth:{},selectedItems:[],searchForm:[],searchFormDisplay:[],searchOn:null,tableHeight:500,currPage:1,currPageSize:0,loading:!1,sort:null}},mounted:function(){this.currPageSize=this.pageSize,this.initSearchForm()},updated:function(){h()("."+this.uid()+" .el-table__expand-icon").off("click").click(this.resetWidth)}},ut={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"listTable",staticClass:"listTable",class:t.uid()},[a("searchFormBuilder",{ref:"searchForm",attrs:{"search-form":t.searchForm,"search-form-display":t.searchFormDisplay,"search-on":t.searchOn},on:{height:t.calcTableHeight}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.operationMode,expression:"operationMode"}],staticClass:"topArea"},[a("div",{staticClass:"tableOperation left"},[t._t("top"),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.searchList}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.cleanForm}},[t._v("重置查询")])],2),t._v(" "),a("div",{staticClass:"tableOperation right"},[a("el-popover",{attrs:{"popper-class":"operations",trigger:"click",title:"批量操作"}},[t.$scopedSlots.operations?a("div",{staticClass:"operations"},[t._t("operations",null,{items:t.selectedItems})],2):a("div",[t._v("无")]),t._v(" "),a("div",{staticClass:"tableButton operations",attrs:{slot:"reference"},slot:"reference"})]),t._v(" "),a("el-popover",{attrs:{"popper-class":"list",trigger:"click",title:"表头筛选"}},[a("el-form",{staticClass:"block"},[a("el-checkbox-group",{model:{value:t.display,callback:function(e){t.display=e},expression:"display"}},t._l(t.fields,function(t){return a("el-checkbox",{key:t.field,attrs:{label:t.title,name:t.field,checked:""}})}),1)],1),t._v(" "),a("div",{staticClass:"tableButton list",attrs:{slot:"reference"},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"tableButton refresh",on:{click:function(e){return t.loadList({})}}}),t._v(" "),a("el-popover",{attrs:{"popper-class":"search",trigger:"click",title:"搜索项筛选"}},[a("el-form",{staticClass:"block"},[a("el-checkbox-group",{model:{value:t.searchFormDisplay,callback:function(e){t.searchFormDisplay=e},expression:"searchFormDisplay"}},t._l(t.searchForm,function(t,e){return a("el-checkbox",{key:e,attrs:{label:t.title,name:t.field}})}),1)],1),t._v(" "),a("div",{staticClass:"tableButton search",attrs:{slot:"reference"},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"tableButton hide",class:{onHide:!t.searchOn},on:{click:function(e){t.searchOn=!t.searchOn}}}),t._v(" "),t.exportPageUrl||t.exportAllUrl?a("el-popover",{attrs:{"popper-class":"export",trigger:"click",title:"导出表单"}},[a("exportContent",{attrs:{"export-page-url":t.exportPageUrl,"export-all-url":t.exportAllUrl,"curr-page":t.currPage,"curr-page-size":t.currPageSize,"get-value":t.getValue}})],1):t._e()],1)]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{border:"",lazy:"",data:t.data,"max-height":t.tableHeight,"row-key":t.dataId,load:t.loadChildren,"tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":t.expandAll},on:{"sort-change":t.sortableHandler,"selection-change":t.selectionChange}},[t.selection?a("el-table-column",{attrs:{fixed:"left",type:"selection","class-name":"mark_selection"}}):t._e(),t._v(" "),t._l(t.fields,function(e,i){return t.display.indexOf(e.title)>=0?a("el-table-column",{key:i,attrs:{prop:e.field,label:e.title,width:t.colWidth[e.field],sortable:!!e.sortable&&"custom","class-name":"mark_"+e.field},scopedSlots:t._u([{key:"default",fn:function(i){return[e.custom?t._t("custom",null,{field:e,item:i.row,index:i.$index,value:i.row[e.field]}):a("span",[t._v(t._s(i.row[e.field]))])]}}],null,!0)}):t._e()}),t._v(" "),t.$scopedSlots.row?a("el-table-column",{attrs:{fixed:"right",label:"操作","class-name":"mark_operation",width:t.colWidth.operation},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("row",null,{item:e.row})]}}],null,!0)}):t._e()],2),t._v(" "),t.pagination?a("el-pagination",{staticClass:"page",attrs:{layout:"total, prev, pager, next, sizes, jumper",background:"","hide-on-single-page":!1,total:t.totalPage,"page-size":t.pageSize,"current-page":t.currPage},on:{"current-change":t.pageChange,"size-change":t.pageSizeChange}}):t._e()],1)},staticRenderFns:[]};var dt=a("VU/8")(ct,ut,!1,function(t){a("CZcV"),a("SExU"),a("jACG")},"data-v-589d0669",null).exports,ft=[{title:"用户ID",field:"user_id",sortable:!0,search:{type:1,checked:!0}},{title:"好感度",field:"user_feeling",sortable:!0,search:!1},{title:"心情值",field:"user_mood",sortable:!0,search:!1},{title:"累计对话数量",field:"message_num",sortable:!0,search:!1},{title:"凭证数量",field:"coupon",sortable:!0,search:!1},{title:"签到状态",field:"sign_in",custom:!0,search:{type:3,data:{0:"未签到",1:"已签到"},checked:!0}},{title:"累计签到次数",field:"sign_times",sortable:!0,search:!1},{title:"黑名单状态",field:"black",custom:!0,search:{type:3,data:{0:"正常",1:"黑名单"},checked:!0}}],ht={name:"UserManager",components:{eTable:dt},methods:{loadUsers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/user/getUsersByPages",data:{page:t,pageSize:a,search:i},success:function(t){e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},setBlackUser:function(t,e){var a=this,i=e?"是否添加用户"+t.user_id+"至黑名单":"是否解除用户"+t.user_id+"的黑名单";this.lib.message.confirm(i,"注意",function(){a.lib.requests.post({url:"/user/setBlackUser",data:{user_id:t.user_id,black:e},successMessage:!0,success:function(t){a.$refs.table.loadList()}})})},sendCoupon:function(t){var e=this,a=[];if(Array.isArray(t)){if(!t.length)return void this.lib.message.alert("请至少选择一个用户");a=t.map(function(t){return t.user_id})}this.lib.message.prompt("输入发放数量","发放凭证",function(t){e.lib.requests.post({url:"/user/sendCoupon",data:{users:a,value:t},successMessage:!0,success:function(t){e.$refs.table.loadList()}})},"number")}},data:function(){return{table:{fields:ft,data:[],total:0}}},mounted:function(){this.loadUsers()}},pt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shadow-box"},[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadUsers},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.sendCoupon(null)}}},[t._v("全体发放凭证")])]},proxy:!0},{key:"operations",fn:function(e){var i=e.items;return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.sendCoupon(i)}}},[t._v("发放凭证")])]}},{key:"custom",fn:function(e){var i=e.field,n=e.value;return["sign_in"===i.field?a("div",[n?a("span",{staticClass:"tag"},[t._v("已签到")]):a("span",[t._v("未签到")])]):t._e(),t._v(" "),"black"===i.field?a("div",[n?a("span",{staticClass:"tag black"},[t._v("黑名单")]):a("span",[t._v("正常")])]):t._e()]}},{key:"row",fn:function(e){var i=e.item;return[0===i.black?a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setBlackUser(i,1)}}},[t._v("加入黑名单")]):t._e(),t._v(" "),1===i.black?a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setBlackUser(i,0)}}},[t._v("解除黑名单")]):t._e()]}}])})],1)},staticRenderFns:[]};var mt=a("VU/8")(ht,pt,!1,function(t){a("Z+Wi")},"data-v-0a4150b9",null).exports,vt={name:"eTabsSwitcher",props:{list:{type:Array,default:function(){return[]}}},watch:{tabIndex:function(t){var e=this;t=parseInt(t),setTimeout(function(){e.openedIndexes.indexOf(t)<0&&e.openedIndexes.push(t)},0===t?0:500)}},methods:{translate:function(){return{transform:"translateX(-"+this.tabIndex*(100/this.list.length)+"%)"}}},data:function(){return{tabIndex:null,openedIndexes:[]}}},gt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tabs"},[t.list.length?a("el-tabs",{model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},t._l(t.list,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.name,name:e.toString()}})}),1):t._e(),t._v(" "),a("div",{staticClass:"container",style:t.translate()},t._l(t.list,function(e,i){return t.openedIndexes.indexOf(i)>=0?a("div",{key:i,staticClass:"block",style:{width:100/t.list.length+"%"}},[a(e.comp,{tag:"component",staticClass:"shadow-box"})],1):t._e()}),0)],1)},staticRenderFns:[]};var bt=a("VU/8")(vt,gt,!1,function(t){a("MD4w")},"data-v-3f88c0e6",null).exports,_t={name:"eForm",props:H,components:{formBuilder:at},computed:{needInit:function(){return{buildData:this.buildData,displayFilter:this.displayFilter,displayAll:this.displayAll}}},watch:{needInit:function(){this.$refs.form.init()}},methods:{getValue:function(t){var e=JSON.parse(u()(this.$refs.form.formData)),a=JSON.parse(u()(this.$refs.form.virtualData));for(var i in e)i in a&&(e[i]=a[i]),e[i].constructor===Boolean&&(e[i]=e[i]?1:0);return t&&t in e?e[t]:e},setValue:function(t,e){if(t.constructor===Object)for(var a in t)this.$refs.form.setValue(a,null!==t[a]&&void 0!==t[a]?t[a]:"");else this.$refs.form.setValue(t,null!==e&&void 0!==e?e:"")},setOptions:function(t,e){if(t.constructor===Object)for(var a in t)this.$refs.form.setOptions(a,t[a]);else this.$refs.form.setOptions(t,e)},setDisabled:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.constructor===Array){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t);!(a=(r=o.next()).done);a=!0){var l=r.value;this.$refs.form.setDisabled(l,e)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}}else this.$refs.form.setDisabled(t,e)},cleanForm:function(t){if(t&&t.constructor===Array){var e=!0,a=!1,i=void 0;try{for(var s,r=n()(t);!(e=(s=r.next()).done);e=!0){var o=s.value;this.$refs.form.cleanForm(o)}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}}else this.$refs.form.cleanForm(t)},reset:function(){this.$set(this.$refs.form,"formData",{}),this.$refs.form.init()}},mounted:function(){this.reset()}},yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"eForm"},[a("formBuilder",{ref:"form",attrs:{size:t.size,inline:t.inline,"label-width":t.labelWidth,"build-data":t.buildData,"display-filter":t.displayFilter,"display-all":t.displayAll,"before-submit":t.beforeSubmit,onchange:t.onchange}}),t._v(" "),a("el-form",{staticClass:"formBuilder"},[t._t("item"),t._v(" "),a("el-form-item",{attrs:{label:" ","label-width":t.labelWidth}},[a("div",[t._t("default")],2)])],2)],1)},staticRenderFns:[]};var wt=a("VU/8")(_t,yt,!1,function(t){a("zBt7")},null,null).exports,kt={0:"普通卡池",1:"限定卡池",2:"联合寻访"},xt={0:"可抽取-限定干员",1:"可抽取-联动干员",2:"不可抽取-非常规途径",3:"不可抽取-销售",4:"不可抽取-公开招募",5:"不可抽取-活动奖励",6:"不可抽取-联动奖励",7:"不可抽取-危机合约奖励",8:"不可抽取-roguelike限定"},St=[{title:"卡池名称",field:"pool_name",search:{type:1,checked:!0}},{title:"6星UP干员",field:"pickup_6",custom:!0,search:{type:1}},{title:"5星UP干员",field:"pickup_5",custom:!0,search:{type:1}},{title:"4星UP干员",field:"pickup_4",custom:!0,search:{type:1}},{title:"权值",field:"pickup_s",custom:!0,search:{type:1}},{title:"卡池属性",field:"limit_pool",custom:!0,search:{type:3,data:kt,checked:!0}}],Ct=[{title:"干员名",field:"operator_name"},{title:"星级",field:"rarity",custom:!0},{title:"职业",field:"classes",custom:!0},{title:"立绘",field:"image",custom:!0}],$t=[{title:"卡池名称",field:"pool_name",config:{type:1}},{title:"6星UP干员",field:"pickup_6",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"5星UP干员",field:"pickup_5",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"4星UP干员",field:"pickup_4",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"权值",field:"pickup_s",config:{type:1}},{title:"卡池属性",field:"limit_pool",config:{type:3,data:kt,default:0}}],Dt=[{title:"非常规获得的干员",field:"operator_name",search:{type:1,checked:!0}},{title:"属性",field:"operator_type",custom:!0,search:{type:3,data:xt,checked:!0}}],Ft=[{title:"ID",field:"conf_id",config:{type:1,disabled:!0}},{title:"非常规获得的干员",field:"operator_name",config:{type:1}},{title:"属性",field:"operator_type",config:{type:3,data:xt,default:0}}],Pt={PIONEER:"先锋",WARRIOR:"近卫",TANK:"重装",SNIPER:"狙击",CASTER:"术师",SUPPORT:"辅助",MEDIC:"医疗",SPECIAL:"特种"},At={name:"GachaConfig",components:{eWindow:v,eTable:dt,eForm:wt},methods:{loadConfig:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/operator/getOperatorGachaConfig",data:{page:t,pageSize:a,search:i},success:function(t){e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},customConfig:function(t,e){var a=this;this.form.type=e,this.$refs.window.show(),this.$nextTick(function(){e?a.$refs.form.setValue(t):a.$refs.form.cleanForm()})},delConfig:function(t){var e=this;this.lib.message.confirm("确定删除该干员配置吗？","请确认",function(){e.lib.requests.post({url:"/operator/delConfig",data:t,successMessage:!0,success:function(t){e.$refs.table.loadList()}})})},submitManage:function(){var t=this,e=this.$refs.form.getValue(),a=1===this.form.type?"/operator/editConfig":"/operator/addNewConfig";""!==e.operator_name?this.lib.requests.post({url:a,data:e,successMessage:!0,success:function(e){t.$refs.window.hide(),t.form.type?t.$refs.table.loadList():t.loadConfig()}}):this.lib.message.toast("干员名称不能为空","error")}},data:function(){return{table:{fields:Dt,data:[],total:0},form:{fields:Ft,type:0},operatorType:xt}},mounted:function(){this.loadConfig()}},It={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadConfig},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.customConfig(null,0)}}},[t._v("新增干员")])]},proxy:!0},{key:"custom",fn:function(e){var i=e.field,n=e.value;return["operator_type"===i.field?a("div",[t._v(t._s(t.operatorType[n]))]):t._e()]}},{key:"row",fn:function(e){var i=e.item;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.customConfig(i,1)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delConfig(i)}}},[t._v("删除")])]}}])}),t._v(" "),a("e-window",{ref:"window",attrs:{title:(1===t.form.type?"修改":"新增")+"干员"}},[a("eForm",{ref:"form",attrs:{"build-data":t.form.fields}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitManage()}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var Tt=a("VU/8")(At,It,!1,function(t){a("JlM0")},"data-v-1cf1e550",null).exports,Lt=a("bOdI"),Ot=a.n(Lt),Ut={name:"eUpload",props:{accept:{type:String,default:function(){return".png,.jpg"}},onUpload:{type:Function,default:function(){return null}}},methods:{upload:function(t,e){this.mark=t,this.filename=e,this.$refs.file.click()}},data:function(){return{mark:null,filename:null}},mounted:function(){var t=this;this.$refs.file.addEventListener("change",function(e){var a=e.target.files;if(a.length){var i=a[0];t.lib.requests.upload(i,t.filename,function(e){t.onUpload(t.mark,e.filename)})}t.$refs.file.value=""})}},Mt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"upload"},[e("input",{ref:"file",attrs:{type:"file",accept:this.accept}})])},staticRenderFns:[]};var Bt={name:"GachaPool",components:{eUpload:a("VU/8")(Ut,Mt,!1,function(t){a("o2uy")},null,null).exports,eWindow:v,eTable:dt,eForm:wt},methods:{loadPool:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/pool/getPoolsByPages",data:{page:t,pageSize:a,search:i},success:function(t){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t.data);!(a=(r=o.next()).done);a=!0)for(var l=r.value,c=["pickup_6","pickup_5","pickup_4"],u=0;u<c.length;u++){var d=c[u];l[d]=l[d]?l[d].split(","):[]}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},pickupSList:function(t){return t?t.split(",").map(function(t){return t.replace("|"," X ")}):[]},getAllOperator:function(t){var e=this;this.lib.requests.post({url:"/operator/getAllOperator",success:function(a){var i={},s=[],r=!0,o=!1,l=void 0;try{for(var c,u=n()(a);!(r=(c=u.next()).done);r=!0){var d=c.value,f=d.rarity,h=d.name;f in i?i[f][h]=h:i[f]=Ot()({},h,h),s.push(h)}}catch(t){o=!0,l=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw l}}e.$set(e,"operators",i),e.$set(e,"operatorsList",s),t&&t()}})},customPool:function(t,e){var a=this;this.form.type=e,this.$refs.window.show(),this.$nextTick(function(){a.$refs.form.setOptions({pickup_6:a.operators[6],pickup_5:a.operators[5],pickup_4:a.operators[4]}),e?a.$refs.form.setValue(t):a.$refs.form.cleanForm(),a.$refs.form.setDisabled("pool_name",1===e),a.$set(a.spForm,"spList",t.spList||[]),a.$nextTick(function(){a.formChange(a.$refs.form.getValue())})})},delPool:function(t){var e=this;this.lib.message.confirm("确定删除卡池【"+t.pool_name+"】吗？","请确认",function(){e.lib.requests.post({url:"/pool/delPool",data:t,successMessage:!0,success:function(t){e.$refs.table.loadList()}})})},submitManage:function(){var t=this,e=this.$refs.form.getValue(),a=1===this.form.type?"/pool/editPool":"/pool/addNewPool";e.pickup_6=e.pickup_6.join(","),e.pickup_5=e.pickup_5.join(","),e.pickup_4=e.pickup_4.join(","),""!==e.pool_name?(e.spList=this.spForm.spList,this.lib.requests.post({url:a,data:e,successMessage:!0,success:function(e){t.$refs.window.hide(),t.form.type?t.$refs.table.loadList():t.loadPool()}})):this.lib.message.toast("卡池名称不能为空","error")},formChange:function(t){for(var e=this,a=[],i=["pickup_6","pickup_5","pickup_4"],s=0;s<i.length;s++){var r=i[s],o=!0,l=!1,c=void 0;try{for(var u,d=n()(t[r]);!(o=(u=d.next()).done);o=!0){var f=u.value;a.push(f)}}catch(t){l=!0,c=t}finally{try{!o&&d.return&&d.return()}finally{if(l)throw c}}}var h=a.filter(function(t){return!e.operatorsList.includes(t)}),p=this.spForm.spList.filter(function(t){var e=h.indexOf(t.operator_name);if(e>=0)return h.splice(e,1),t}),m=!0,v=!1,g=void 0;try{for(var b,_=n()(h);!(m=(b=_.next()).done);m=!0){var y=b.value;p.push({operator_name:y,rarity:"",classes:"",image:""})}}catch(t){v=!0,g=t}finally{try{!m&&_.return&&_.return()}finally{if(v)throw g}}this.$set(this.spForm,"spList",p)},upload:function(t,e){this.$refs.upload.upload(t,e.operator_name+".png")},onUpload:function(t,e){this.spForm.spList[t].image=e},showImage:function(t){window.open("http://"+window.serverHost+"/images/"+t.operator_name+".png")}},data:function(){return{table:{fields:St,data:[],total:0},form:{fields:$t,type:0},spForm:{spTable:Ct,spList:[]},classes:Pt,operators:{},operatorsList:[]}},mounted:function(){this.getAllOperator(this.loadPool)}},Vt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadPool},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.customPool(null,0)}}},[t._v("新增卡池")])]},proxy:!0},{key:"custom",fn:function(e){var i=e.field,n=e.value;return["limit_pool"===i.field?a("div",[0===n?a("span",[t._v("普通卡池")]):t._e(),t._v(" "),1===n?a("span",{staticClass:"tag tag1"},[t._v("限定卡池")]):t._e(),t._v(" "),2===n?a("span",{staticClass:"tag tag2"},[t._v("联合寻访")]):t._e()]):t._e(),t._v(" "),["pickup_6","pickup_5","pickup_4"].indexOf(i.field)>=0?a("div",t._l(n,function(e,i){return a("span",{key:i,staticClass:"tag"},[t._v(t._s(e))])}),0):t._e(),t._v(" "),"pickup_s"===i.field?a("div",t._l(t.pickupSList(n),function(e,i){return a("span",{key:i,staticClass:"tag"},[t._v("\n                    "+t._s(e)+"\n                ")])}),0):t._e()]}},{key:"row",fn:function(e){var i=e.item;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.customPool(i,1)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delPool(i)}}},[t._v("删除")])]}}])}),t._v(" "),a("e-window",{ref:"window",attrs:{title:(1===t.form.type?"修改":"新增")+"卡池"}},[a("eForm",{ref:"form",attrs:{"build-data":t.form.fields,onchange:t.formChange}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitManage()}}},[t._v("提交")]),t._v(" "),a("el-badge",{staticClass:"item",attrs:{value:t.spForm.spList.length,hidden:!t.spForm.spList.length}},[a("el-button",{on:{click:function(){return t.$refs.spOperator.show()}}},[t._v("设置自定义干员")])],1)],1),t._v(" "),a("e-window",{ref:"spOperator",attrs:{title:"设置自定义干员"}},[a("el-alert",{attrs:{title:"为什么要设置自定义干员？",closable:!1}},[a("div",{staticClass:"alert"},[t._v("\n                    自定义干员为不存在列表内的干员，因此不具备干员ID（char_id），即使在对应星级的UP干员内设置，仍无法在抽卡时为其匹配\n                    "),a("span",[t._v("星级")]),t._v("、"),a("span",[t._v("职业")]),t._v(" 以及 "),a("span",[t._v("立绘")]),t._v(" 等信息。\n                ")])]),t._v(" "),a("br"),t._v(" "),a("e-table",{attrs:{fields:t.spForm.spTable,data:t.spForm.spList,"operation-mode":!1,"auto-reset":!1,pagination:!1,selection:!1},scopedSlots:t._u([{key:"custom",fn:function(e){var i=e.field,n=e.value,s=e.index,r=e.item;return["rarity"===i.field?a("div",[a("el-select",{attrs:{placeholder:"请选择星级",size:"mini"},model:{value:t.spForm.spList[s].rarity,callback:function(e){t.$set(t.spForm.spList[s],"rarity",e)},expression:"spForm.spList[index].rarity"}},t._l([1,2,3,4,5,6],function(t){return a("el-option",{key:t,attrs:{label:t+"星",value:t}})}),1)],1):t._e(),t._v(" "),"classes"===i.field?a("div",[a("el-select",{attrs:{placeholder:"请选择职业",size:"mini"},model:{value:t.spForm.spList[s].classes,callback:function(e){t.$set(t.spForm.spList[s],"classes",e)},expression:"spForm.spList[index].classes"}},t._l(t.classes,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})}),1)],1):t._e(),t._v(" "),"image"===i.field?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.upload(s,r)}}},[t._v("点击上传")]),t._v(" "),n?a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showImage(r)}}},[t._v("预览")]):t._e()],1):t._e()]}}])})],1)],1),t._v(" "),a("e-upload",{ref:"upload",attrs:{"on-upload":t.onUpload}})],1)},staticRenderFns:[]};var Rt=a("VU/8")(Bt,Vt,!1,function(t){a("nyNF")},"data-v-594a20e8",null).exports,Et={name:"GachaManager",components:{eTabsSwitcher:bt},data:function(){return{tabs:[{name:"卡池列表",comp:Rt},{name:"限定干员管理",comp:Tt}]}}},zt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"gacha-manager"},[e("e-tabs-switcher",{attrs:{list:this.tabs}})],1)},staticRenderFns:[]};var qt=a("VU/8")(Et,zt,!1,function(t){a("0QAm")},"data-v-8e694826",null).exports,Nt=[{title:"群号",field:"group_id",sortable:!0,search:{type:1,checked:!0}},{title:"群名称",field:"group_name",sortable:!0,search:{type:1,checked:!0}},{title:"BOT群内权限",field:"permission",search:{type:3,data:{MEMBER:"成员",ADMINISTRATOR:"管理员"},checked:!0}},{title:"30天内使用数量",field:"message_num",sortable:!0,search:!1},{title:"启用状态",field:"active",custom:!0,search:{type:3,data:{0:"否",1:"是"},checked:!0}},{title:"允许推送公告",field:"send_notice",custom:!0,search:{type:3,data:{0:"否",1:"是"},checked:!0}},{title:"允许推送微博",field:"send_weibo",custom:!0,search:{type:3,data:{0:"否",1:"是"},checked:!0}}],Wt=[{title:"公告ID",field:"notice_id",search:!1},{title:"公告内容",field:"content",search:{type:1,checked:!0}},{title:"推送人",field:"send_user",search:{type:1,checked:!0}},{title:"推送时间",field:"send_time",search:!1}],Ht={name:"GroupList",components:{eTable:dt},methods:{loadGroups:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/group/getGroupByPages",data:{page:t,pageSize:a,search:i},success:function(t){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t.data);!(a=(r=o.next()).done);a=!0){var l=r.value;null===l.active&&(l.active=1),null===l.send_notice&&(l.send_notice=0),null===l.send_weibo&&(l.send_weibo=0)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},getMemberList:function(t){this.lib.requests.post({url:"/group/getMemberList",data:{group_id:t.group_id},success:function(t){}})},changeGroupStatus:function(t,e,a){var i=this;this.lib.requests.post({url:"/group/changeGroupStatus",data:Ot()({group_id:t.group_id},e,a),success:function(t){i.$refs.table.loadList()}})},leaveGroup:function(t){var e=this;this.lib.message.confirm("确定退出群【"+t.group_id+"】吗？这将同步删除该群的设置。","注意",function(){e.lib.requests.post({url:"/group/leaveGroup",data:{group_id:t.group_id},successMessage:!0,success:function(t){e.$refs.table.loadList()}})})},refreshGroup:function(){var t=this;this.lib.requests.post({url:"/group/refreshGroupList",success:function(e){t.$refs.table.loadList()}})},pushNotice:function(){}},data:function(){return{table:{fields:Nt,data:[],total:0},notice:""}},mounted:function(){this.loadGroups()}},jt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadGroups},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.refreshGroup()}}},[t._v("同步群列表")])]},proxy:!0},{key:"custom",fn:function(e){var i=e.item,n=e.field,s=e.value;return[["active","send_notice","send_weibo"].indexOf(n.field)>=0?a("div",[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":0},on:{change:function(e){return t.changeGroupStatus(i,n.field,s)}},model:{value:s,callback:function(t){s=t},expression:"value"}})],1):t._e()]}},{key:"row",fn:function(e){var i=e.item;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.getMemberList(i)}}},[t._v("查看群成员")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.leaveGroup(i)}}},[t._v("退出群")])]}}])})],1)},staticRenderFns:[]};var Gt=a("VU/8")(Ht,jt,!1,function(t){a("sda3")},"data-v-4da53404",null).exports,Jt={name:"GroupNotice",components:{eTable:dt,eWindow:v},methods:{loadGroupNotice:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/group/getGroupNoticeByPages",data:{page:t,pageSize:a,search:i},success:function(t){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t.data);!(a=(r=o.next()).done);a=!0){var l=r.value;l.send_time=e.lib.common.formatDate(l.send_time)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},inputNotice:function(){this.notice="",this.$refs.notice.show()},pushNotice:function(){var t=this;this.lib.requests.post({url:"/group/pushNotice",data:{content:this.notice},successMessage:!0,success:function(e){t.$refs.table.loadList(),t.$refs.notice.hide()}})},pushAgain:function(t){var e=this;this.lib.message.confirm("确定重新推送该公告吗","注意",function(){e.notice=t.content,e.pushNotice()})},delNotice:function(t){var e=this;this.lib.requests.post({url:"/group/delNotice",data:t,successMessage:!0,success:function(t){e.$refs.table.loadList()}})}},data:function(){return{table:{fields:Wt,data:[],total:0},notice:""}},mounted:function(){this.loadGroupNotice()}},Yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadGroupNotice},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:t.inputNotice}},[t._v("推送公告")])]},proxy:!0},{key:"row",fn:function(e){var i=e.item;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.pushAgain(i)}}},[t._v("再次推送")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delNotice(i)}}},[t._v("删除")])]}}])}),t._v(" "),a("e-window",{ref:"notice",attrs:{title:"推送公告"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",rows:10},model:{value:t.notice,callback:function(e){t.notice=e},expression:"notice"}})],1),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.pushNotice}},[t._v("推送")])],1)],1)},staticRenderFns:[]};var Qt=a("VU/8")(Jt,Yt,!1,function(t){a("Nz8C")},"data-v-90bf1db0",null).exports,Zt={name:"GroupManager",components:{eTabsSwitcher:bt},data:function(){return{tabs:[{name:"群组列表",comp:Gt},{name:"公告管理",comp:Qt}]}}},Kt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"group-manager"},[e("e-tabs-switcher",{attrs:{list:this.tabs}})],1)},staticRenderFns:[]};var Xt=a("VU/8")(Zt,Kt,!1,function(t){a("/HYw")},"data-v-37f87241",null).exports,te={name:"AdminList",components:{eWindow:v,eTable:dt,eForm:wt},methods:{loadAdmin:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/admin/getAdminsByPages",data:{page:t,pageSize:a,search:i},success:function(t){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t.data);!(a=(r=o.next()).done);a=!0){var l=r.value;l.last_login=e.lib.common.formatDate(l.last_login)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},addAdmin:function(){var t=this;this.lib.message.prompt("请输入要注册的管理员ID","注册管理员",function(e){t.lib.requests.post({url:"/admin/registerAdmin",data:{user_id:e},successMessage:!0,success:function(e){t.$refs.table.loadList()}})})},setActive:function(t,e){var a=this;this.lib.requests.post({url:"/admin/setActive",data:{user_id:t.user_id,active:e},successMessage:!0,success:function(t){a.$refs.table.loadList()}})},delAdmin:function(t){var e=this;this.lib.message.confirm("确定删除管理员【"+t.user_id+"】吗？将同步删除该管理员的行为记录","请确认",function(){e.lib.requests.post({url:"/admin/delAdmin",data:{user_id:t.user_id},successMessage:!0,success:function(t){e.$refs.table.loadList()}})})}},data:function(){return{table:{fields:[{title:"账户名",field:"user_id",search:{type:1,checked:!0}},{title:"密码",field:"password",search:!1},{title:"最后登录时间",field:"last_login",search:!1},{title:"最后登录IP地址",field:"last_login_ip",search:!1},{title:"是否启用",field:"active",custom:!0,search:{type:3,data:{0:"启用",1:"禁用"},checked:!0}}],data:[],total:0}}},mounted:function(){this.loadAdmin()}},ee={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadAdmin},scopedSlots:t._u([{key:"top",fn:function(){return[a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addAdmin(null,0)}}},[t._v("注册管理员")])]},proxy:!0},{key:"custom",fn:function(e){var i=e.field,n=e.value;return["active"===i.field?a("div",[n?a("span",{staticClass:"tag"},[t._v("已启用")]):a("span",[t._v("未启用")])]):t._e()]}},{key:"row",fn:function(e){var i=e.item;return[1===i.active?a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setActive(i,0)}}},[t._v("禁用")]):t._e(),t._v(" "),0===i.active?a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setActive(i,1)}}},[t._v("启用")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delAdmin(i)}}},[t._v("删除")])]}}])})],1)},staticRenderFns:[]};var ae=a("VU/8")(te,ee,!1,function(t){a("SE3W")},"data-v-5691779c",null).exports,ie={name:"AdminList",components:{eWindow:v,eTable:dt,eForm:wt},methods:{loadAdminTrace:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/admin/getAdminTraceByPages",data:{page:t,pageSize:a,search:i},success:function(t){var a=!0,i=!1,s=void 0;try{for(var r,o=n()(t.data);!(a=(r=o.next()).done);a=!0){var l=r.value;l.time=e.lib.common.formatDate(l.time)}}catch(t){i=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})}},data:function(){return{table:{fields:[{title:"账户名",field:"user_id",search:{type:1,checked:!0}},{title:"调用接口",field:"interface",search:{type:1,checked:!0}},{title:"JSON参数",field:"params",search:!1},{title:"时间",field:"time",search:!1}],data:[],total:0}}},mounted:function(){this.loadAdminTrace()}},ne={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("e-table",{ref:"table",attrs:{fields:this.table.fields,data:this.table.data,"total-page":this.table.total,"list-loader":this.loadAdminTrace}})],1)},staticRenderFns:[]};var se=a("VU/8")(ie,ne,!1,function(t){a("AYLs")},"data-v-264517ea",null).exports,re={name:"AdminManager",components:{eTabsSwitcher:bt},data:function(){return{tabs:[{name:"管理员列表",comp:ae},{name:"管理员行为记录",comp:se}]}}},oe={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"admin-manager"},[e("e-tabs-switcher",{attrs:{list:this.tabs}})],1)},staticRenderFns:[]};var le=a("VU/8")(re,oe,!1,function(t){a("29EV")},"data-v-48bc0b49",null).exports,ce={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form-item",{attrs:{label:"月卡登录获得"}},[a("el-input-number",{attrs:{size:"mini"},model:{value:t.data.jadeSetting.signIn,callback:function(e){t.$set(t.data.jadeSetting,"signIn",e)},expression:"data.jadeSetting.signIn"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"每日任务获得"}},[a("el-input-number",{attrs:{size:"mini"},model:{value:t.data.jadeSetting.dailyTasks,callback:function(e){t.$set(t.data.jadeSetting,"dailyTasks",e)},expression:"data.jadeSetting.dailyTasks"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"每周任务获得"}},[a("el-input-number",{attrs:{size:"mini"},model:{value:t.data.jadeSetting.weeklyTasks,callback:function(e){t.$set(t.data.jadeSetting,"weeklyTasks",e)},expression:"data.jadeSetting.weeklyTasks"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"每日剿灭获得"}},[a("el-input-number",{attrs:{size:"mini"},model:{value:t.data.jadeSetting.weeklyBattle,callback:function(e){t.$set(t.data.jadeSetting,"weeklyBattle",e)},expression:"data.jadeSetting.weeklyBattle"}})],1)],1)},staticRenderFns:[]};var ue={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form-item",{attrs:{label:"发送GIF"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.data.weiboSetting.weiboSendGIF,callback:function(e){t.$set(t.data.weiboSetting,"weiboSendGIF",e)},expression:"data.weiboSetting.weiboSendGIF"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"自动推送新微博"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.data.weiboSetting.weiboAutoPush,callback:function(e){t.$set(t.data.weiboSetting,"weiboAutoPush",e)},expression:"data.weiboSetting.weiboAutoPush"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"新微博检查频率"}},[a("el-input-number",{attrs:{size:"mini",step:30},model:{value:t.data.weiboSetting.checkRate,callback:function(e){t.$set(t.data.weiboSetting,"checkRate",e)},expression:"data.weiboSetting.checkRate"}})],1)],1)},staticRenderFns:[]};var de={name:"SubSettingReplace",props:["data"],components:{eTable:dt},methods:{loadSetting:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/setting/getReplaceTextByPages",data:{page:t,pageSize:a,search:i},success:function(t){e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},changeStatus:function(t,e,a){var i=this,n=JSON.parse(u()(t));n[e]=a,this.lib.requests.post({url:"/setting/changeReplaceTextStatus",data:n,success:function(t){i.$refs.table.loadList()}})}},data:function(){return{table:{fields:[{title:"提交用户",field:"user_id",search:{type:1,checked:!0}},{title:"所在群组",field:"group_id",search:{type:1}},{title:"原字符",field:"origin",search:{type:1,checked:!0}},{title:"替换字符",field:"target",search:{type:1,checked:!0}},{title:"提交时间",field:"in_time",search:!1},{title:"是否全局适用",field:"is_global",custom:!0,search:{type:3,data:{0:"否",1:"是"}}},{title:"是否通过审核",field:"is_active",custom:!0,search:{type:3,data:{0:"否",1:"是"}}}],data:[],total:0}}},mounted:function(){this.loadSetting()}},fe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%"}},[a("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadSetting},scopedSlots:t._u([{key:"custom",fn:function(e){var i=e.item,n=e.field,s=e.value;return[["is_global","is_active"].indexOf(n.field)>=0?a("div",[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":1,"inactive-value":0},on:{change:function(e){return t.changeStatus(i,n.field,s)}},model:{value:s,callback:function(t){s=t},expression:"value"}})],1):t._e()]}},{key:"row",fn:function(e){return e.item,[a("el-button",{attrs:{type:"text"}},[t._v("删除")])]}}])})],1)},staticRenderFns:[]};var he={name:"FunctionSetting",components:{SubSettingJade:a("VU/8")({name:"SubSettingJade",props:["data"]},ce,!1,function(t){a("7tc7")},"data-v-f7cf5c2e",null).exports,SubSettingWeibo:a("VU/8")({name:"SubSettingWeibo",props:["data"]},ue,!1,function(t){a("Bv3T")},"data-v-20679bb6",null).exports,SubSettingReplace:a("VU/8")(de,fe,!1,function(t){a("Y6Wh")},"data-v-8eb2ccc6",null).exports},methods:{loadSetting:function(){var t=this;this.lib.requests.post({url:"/getFunctionSetting",success:function(e){var a=JSON.parse(u()(U));e&&q()(a,JSON.parse(u()(t.data)),e),t.$set(t,"data",a)}})},saveSetting:function(){var t=this;this.lib.requests.post({url:"/saveFunctionSetting",data:this.data,successMessage:!0,success:function(e){t.loadSetting()}})},selectSetting:function(t){this.currId=t}},data:function(){return{functions:O,data:U,currId:null}},mounted:function(){this.loadSetting()}},pe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"functionSetting"},[a("el-card",{staticClass:"box-card"},[a("el-tabs",{staticStyle:{height:"100%"},attrs:{"tab-position":"left"}},t._l(t.functions,function(e,i){return a("el-tab-pane",{key:i},[a("div",{attrs:{slot:"label"},on:{click:function(e){return t.selectSetting(i)}},slot:"label"},[t._v("\n                    "+t._s(e)+"\n                    "),a("span",{staticClass:"mark",class:t.data.globalState[i]?"green":"red"})]),t._v(" "),a("div",{staticClass:"setting-body"},[a("div",{staticClass:"setting-head"},[a("div",{staticClass:"setting-title"},[a("i",{staticClass:"el-icon-s-tools"}),t._v(" "),a("span",[t._v(t._s(e)+"设置")]),t._v(" "),a("el-tooltip",{attrs:{content:"全局开关",placement:"top"}},[a("el-switch",{model:{value:t.data.globalState[i],callback:function(e){t.$set(t.data.globalState,i,e)},expression:"data.globalState[id]"}})],1)],1),t._v(" "),a("div",{staticClass:"button-group"},[a("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.saveSetting}},[t._v("保存")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.loadSetting}},[t._v("重置")])],1)]),t._v(" "),a("el-divider",{attrs:{"content-position":"right"}},[t._v("@Amiya-Bot Functions System")]),t._v(" "),a("el-form",{staticClass:"form",attrs:{size:"small","label-width":"120px","label-position":"left"}},["jadeCalculator"===t.currId?a("SubSettingJade",{attrs:{data:t.data}}):"weibo"===t.currId?a("SubSettingWeibo",{attrs:{data:t.data}}):"replaceText"===t.currId?a("SubSettingReplace",{attrs:{data:t.data}}):a("el-empty",{attrs:{description:"暂无需要设置的选项"}})],1)],1)])}),1)],1)],1)},staticRenderFns:[]};var me=a("VU/8")(he,pe,!1,function(t){a("i/n2"),a("aY69")},"data-v-068fd850",null).exports,ve={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sourceManager"},[a("el-card",{staticClass:"box-card"},[a("el-descriptions",{attrs:{title:"重要资源",column:2,size:"mini",border:""}},[a("el-descriptions-item",{attrs:{label:"游戏数据"}},[a("div",{domProps:{innerHTML:t._s(t.data.gameData)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"样式文件"}},[a("div",{domProps:{innerHTML:t._s(t.data.style)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"数据库文件"}},[a("div",{domProps:{innerHTML:t._s(t.data.database)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"前端文件"}},[a("div",{domProps:{innerHTML:t._s(t.data.console)}})])],1)],1),t._v(" "),a("el-card",{staticClass:"box-card"},[a("el-descriptions",{attrs:{title:"抽卡资源",column:2,size:"mini",border:""}},[a("el-descriptions-item",{attrs:{label:"职业图标"}},[a("div",{domProps:{innerHTML:t._s(t.data.class)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"十连背景图片"}},[a("div",{domProps:{innerHTML:t._s(t.data.gacha)}})])],1)],1),t._v(" "),a("el-card",{staticClass:"box-card"},[a("el-descriptions",{attrs:{title:"游戏静态资源",column:2,size:"mini",border:""}},[a("template",{slot:"extra"},[a("el-button",{staticClass:"el-icon-refresh",attrs:{type:"text",size:"medium"},on:{click:t.refresh}},[t._v("刷新资源")])],1),t._v(" "),a("el-descriptions-item",{attrs:{label:"阿米娅语音"}},[a("div",{domProps:{innerHTML:t._s(t.data.AmiyaVoices)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"干员头像"}},[a("div",{domProps:{innerHTML:t._s(t.data.avatars)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"干员半身照"}},[a("div",{domProps:{innerHTML:t._s(t.data.portraits)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"技能图标"}},[a("div",{domProps:{innerHTML:t._s(t.data.skills)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"材料图标"}},[a("div",{domProps:{innerHTML:t._s(t.data.materials)}})]),t._v(" "),a("el-descriptions-item",{attrs:{label:"敌人头像"}},[a("div",{domProps:{innerHTML:t._s(t.data.enemies)}})])],2)],1)],1)},staticRenderFns:[]};var ge=a("VU/8")({name:"SourceManager",methods:{getData:function(){var t=this;this.lib.requests.post({url:"/getSourceDownloadState",success:function(e){var a={};for(var i in e){var n=e[i].split("/"),s=n[0]!==n[1]?"red":"";a[i]='<span style="color: '+s+'">'+n[0]+"</span> / <span>"+n[1]+"</span>"}t.$set(t,"data",a)}})},refresh:function(){var t=this;this.lib.message.confirm("刷新资源会开始下载缺失的资源，将耗费一定时间，请耐心等待","注意",function(){t.lib.requests.post({url:"/refreshSource"})})}},data:function(){return{data:{}}},mounted:function(){this.getData()}},ve,!1,function(t){a("vDZY")},"data-v-86fb339e",null).exports;s.default.use(y.a);var be=new y.a({routes:[{path:"/",name:"Login",component:x},{path:"/index",name:"Dashboard",component:E},{path:"/user",name:"UserManager",component:mt},{path:"/group",name:"GroupManager",component:Xt},{path:"/gacha",name:"GachaManager",component:qt},{path:"/admin",name:"AdminManager",component:le},{path:"/function",name:"FunctionSetting",component:me},{path:"/source",name:"SourceManager",component:ge}]}),_e=a("pFYg"),ye=a.n(_e),we=a("Zrlr"),ke=a.n(we),xe=a("wxAW"),Se=a.n(xe),Ce=function(){function t(){ke()(this,t)}return Se()(t,[{key:"saveData",value:function(t,e){var a=null;"object"===(void 0===e?"undefined":ye()(e))&&(a=u()(e)),"string"!=typeof e&&"number"!=typeof e||(a=e.toString()),a&&localStorage.setItem(t,a)}},{key:"getData",value:function(t){var e=localStorage.getItem(t);if(e){try{e=JSON.parse(e)}catch(t){}return e}}},{key:"removeData",value:function(t){localStorage.removeItem(t)}},{key:"formatDate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y-m-d h:i:s";if(t){var a=t*(t.toString().length<13?1e3:1),i=new Date(a),n=function(t){return parseInt(t)<10?"0"+t:t},s={y:i.getFullYear(),m:n(i.getMonth()+1),d:n(i.getDate()),h:n(i.getHours()),i:n(i.getMinutes()),s:n(i.getSeconds())};for(var r in s)e=e.replace(new RegExp(r,"g"),s[r]);return e}return t}}]),t}(),$e=a("mtWM"),De=a.n($e),Fe=a("zL8q"),Pe=a.n(Fe),Ae=function(){function t(){ke()(this,t),this.info="info",this.error="error",this.success="success",this.warning="warning"}return Se()(t,[{key:"toast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.success;Object(Fe.Message)({type:e,message:t})}},{key:"notify",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.info,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;Object(Fe.Notification)({type:a,title:e,message:t,duration:i})}},{key:"alert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",a=arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.info;Fe.MessageBox.alert(t,e,{type:i,confirmButtonText:"好的",callback:a}).then(null)}},{key:"confirm",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",a=arguments[2],i=arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.warning;Fe.MessageBox.confirm(t,e,{type:n,confirmButtonText:"确定",cancelButtonText:"取消"}).then(a||null).catch(i||null)}},{key:"prompt",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",a=arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";Fe.MessageBox.prompt(t,e,{confirmButtonText:"确定",cancelButtonText:"取消",inputType:i}).then(function(t){a&&a(t.value)})}}]),t}();window.axiosRequestsList=[],De.a.defaults.withCredentials=!0;var Ie,Te=function(){function t(e){ke()(this,t),this.host=e.host,this.message=new Ae}return Se()(t,[{key:"httpRequests",value:function(t,e){var a=this;try{var i=e.url,n=e.data||{},s=void 0!==e.successMessage&&e.successMessage,r=e.success,o=e.error,l=e.complete,c=e.headers,d=["PUT","POST","PATCH"].indexOf(t.toUpperCase())>=0,f=d?"data":"params",h=d&&e.json?u()(n):n,p=Ot()({url:"http://"+this.host+i,method:t,headers:{"Content-Type":"application/json"},cancelToken:new De.a.CancelToken(function(t){window.axiosRequestsList.push({cancel:t})})},f,h);for(var m in c)p.headers[m]=c[m];var v=Fe.Loading.service({lock:!0,text:"正在请求服务器...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.3)"});De()(p).then(function(t){var e=t.data;if(200===t.status){var i=e.code,n=e.message;switch(i){case 200:s&&n&&s&&a.message.notify(n,"提示",a.message.success),r&&r(e.data);break;case 300:a.message.notify(n,"提示",a.message.success);break;case 400:a.message.alert(n,"Access 错误",function(){location.href="/"});break;case 0:a.message.notify(n,"提示",a.message.warning),o&&o()}}}).catch(function(t){a.message.notify(t.toString(),"请求发生错误",a.message.error)}).finally(function(){v.close(),l&&l()})}catch(o){throw o}}},{key:"get",value:function(t){this.httpRequests("get",t)}},{key:"post",value:function(t){this.httpRequests("post",t)}},{key:"upload",value:function(t,e,a){var i=new FormData,n={url:"/upload",headers:{"Content-Type":"multipart/form-data"},json:!1,successMessage:!0,success:a};i.append("file",t),i.append("filename",e),n.data=i,this.httpRequests("post",n)}}]),t}();a("tvR6");s.default.use(Pe.a),s.default.config.productionTip=!1,s.default.prototype.lib=(Ie={host:window.serverHost},{common:new Ce,requests:new Te(Ie),message:new Ae}),be.beforeEach(function(t,e,a){var i=!0,s=!1,r=void 0;try{for(var o,l=n()(window.axiosRequestsList);!(i=(o=l.next()).done);i=!0){o.value.cancel()}}catch(t){s=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(s)throw r}}window.axiosRequestsList=[],a()}),new s.default({el:"#app",router:be,components:{App:_},template:"<App/>"})},Nz8C:function(t,e){},QF50:function(t,e){},SE3W:function(t,e){},SExU:function(t,e){},TE5g:function(t,e){},V47x:function(t,e){},Y6Wh:function(t,e){},"Z+Wi":function(t,e){},aSaL:function(t,e){},aY69:function(t,e){},baHF:function(t,e){},e29U:function(t,e){},hAhP:function(t,e){},"i/n2":function(t,e){},jACG:function(t,e){},mQtQ:function(t,e){},mxPJ:function(t,e){},ny9V:function(t,e){},nyNF:function(t,e){},o2uy:function(t,e){},qQ8M:function(t,e){},sda3:function(t,e){},tvR6:function(t,e){},u66W:function(t,e){},uCiw:function(t,e){},vDZY:function(t,e){},wxIg:function(t,e){},zBt7:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b983bf700f01739966b1.js.map