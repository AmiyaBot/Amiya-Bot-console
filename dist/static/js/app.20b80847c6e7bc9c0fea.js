webpackJsonp([1],{"0kGW":function(t,e){},"4ACZ":function(t,e){},"7OpQ":function(t,e){},"8Exs":function(t,e){},KcHc:function(t,e){},NABe:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("BO1k"),n=i.n(a),s=i("7+uW"),r={name:"SubPage",props:{title:String}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sub-page"},[i("div",{staticClass:"sub-page-title"},[t._v(t._s(t.title))]),t._v(" "),i("div",{staticClass:"sub-page-content"},[t._t("default",function(){return[t._v("在做了在做了（下次一定）……")]})],2)])},staticRenderFns:[]};var l=i("VU/8")(r,o,!1,function(t){i("aSaL")},"data-v-e5d071e2",null).exports,c=i("mvHQ"),d=i.n(c),u=new s.default,f=i("7t+N"),h=i.n(f),p={name:"eWindow",props:{windowId:String,title:String,width:String,type:String,submit:Function,onClose:Function,beforeClose:Function,fullscreen:Boolean,appendToBody:{type:Boolean,default:!0},enableDrag:{type:Boolean,default:!1},shadeClose:{type:Boolean,default:!0}},watch:{visible:function(t){var e=this;if(!t&&this.onClose&&this.onClose(this.windowId||this.uid()),t&&this.drag){var i="."+this.uid()+" .el-dialog__header";this.$nextTick(function(){h()(i).off().on({mousedown:function(){h()(i).on("mousemove",function(t){e.positions.x+=t.originalEvent.movementX,e.positions.y+=t.originalEvent.movementY})},mouseup:function(){h()(i).off("mousemove")}})})}!this.top&&this.topParents&&this.$nextTick(function(){u.$emit("windowBus"+e.topParents,{uid:e.uid(),status:t})})},positions:{handler:function(){h()("."+this.uid()).css({top:this.positions.y,left:this.positions.x})},deep:!0}},methods:{uid:function(){return"Window"+this._uid},show:function(){this.visible=!0},hide:function(){this.visible=!1},submitAction:function(){this.submit?this.submit():this.hide()},foundParents:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return void 0!==t.$parent?("eWindow"===t.$parent.$options.name&&e.unshift(t.$parent.uid()),this.foundParents(t.$parent,e)):e}},data:function(){return{top:!1,topParents:null,visible:!1,drag:!1,children:[],positions:{x:0,y:0}}},mounted:function(){var t=this,e=this.foundParents();this.drag=!e.length&&(this.enableDrag&&!this.fullscreen),this.topParents=e.length?e[0]:null,this.top=!e.length,this.top&&(this.children.push(this.uid()),u.$on("windowBus"+this.uid(),function(e){var i=t.children,a=i.indexOf(e.uid);e.status?i.push(e.uid):i.splice(a,1);var n=JSON.parse(d()(i)).reverse(),s=0;for(var r in n){var o=h()(".custom-window."+n[r]),l=h()(".custom-window."+n[parseInt(r)-1]),c=l.length?(l.width()-o.width())/2:0,u=o.width()+c+s+20;o.css({transform:"translateX(-"+(r>0?u:0)+"px)",transition:"transform 400ms ease-in-out"}),s+=r>0?u:0}}))}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.title,width:t.width||"700px",visible:t.visible,fullscreen:t.fullscreen,"append-to-body":t.appendToBody,center:!0,"show-close":!0,"before-close":t.beforeClose,"close-on-click-modal":t.shadeClose,"custom-class":["custom-window",t.uid()].join(" ")},on:{"update:visible":function(e){t.visible=e}}},["form"===t.type?[i("el-form",{staticStyle:{overflow:"hidden"},attrs:{"label-width":"120px",size:"small"}},[t._t("default")],2),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[t._t("button",function(){return[i("el-button",{on:{click:t.hide}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.submitAction}},[t._v("确定")])]})],2)]:[t._t("default")]],2)},staticRenderFns:[]};var v=i("VU/8")(p,m,!1,function(t){i("pE/J")},null,null).exports,g={name:"App",components:{EWindow:v,SubPage:l},methods:{getTitle:function(){var t=this.$route.path,e=!0,i=!1,a=void 0;try{for(var s,r=n()(this.nav.list);!(e=(s=r.next()).done);e=!0){var o=s.value;if(o.path===t)return o.title.toUpperCase()}}catch(t){i=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw a}}return"None"},handleCommand:function(t){switch(t){case"editPassword":this.$refs.editPassword.show();break;case"logout":this.logout()}},editPassword:function(){var t=this;if(this.form.newPassword!==this.form.newPasswordConfirm)return this.lib.message.notify("新密码不一致"),!1;this.lib.requests.post({url:"/editPassword",data:this.form,successMessage:!0,success:function(e){t.$refs.editPassword.hide()}})},logout:function(){var t=this;this.lib.message.confirm("确定退出登录吗？","退出登录",function(){t.lib.requests.post({url:"/logout",success:function(t){location.href="/"}})})}},data:function(){return{nav:{list:[{path:"/index",name:"概况看板",title:"概况看板"},{path:"/group",name:"群组",title:"群组管理"},{path:"/user",name:"用户",title:"用户管理"},{path:"/gacha",name:"抽卡",title:"抽卡管理"},{path:"/trace",name:"管理员",title:"管理员管理"},{path:"/config",name:"设置",title:"Bot 设置"}]},form:{password:"",newPassword:"",newPasswordConfirm:""},icp:window.icp}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},["/"!==t.$route.path?[i("div",{staticClass:"main-header"},[i("div",{staticClass:"title"},[t._v("Amiya-bot Console")]),t._v(" "),i("div",{staticClass:"nav"},t._l(t.nav.list,function(e){return i("div",{key:e.path,class:{curr:e.path===t.$route.path},on:{click:function(i){return t.$router.push(e.path)}}},[i("span",[t._v(t._s(e.name))])])}),0),t._v(" "),i("div",{staticClass:"user-menu"},[i("el-dropdown",{on:{command:t.handleCommand}},[i("span",{staticClass:"user"},[t._v("登录菜单"),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"editPassword"}},[t._v("修改密码")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出登录")])],1)],1)],1)]),t._v(" "),i("e-window",{ref:"editPassword",attrs:{title:"修改密码",type:"form",submit:t.editPassword}},[i("el-form-item",{attrs:{label:"原密码"}},[i("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"新密码"}},[i("el-input",{attrs:{type:"password"},model:{value:t.form.newPassword,callback:function(e){t.$set(t.form,"newPassword",e)},expression:"form.newPassword"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"确认新密码"}},[i("el-input",{attrs:{type:"password"},model:{value:t.form.newPasswordConfirm,callback:function(e){t.$set(t.form,"newPasswordConfirm",e)},expression:"form.newPasswordConfirm"}})],1)],1),t._v(" "),i("div",{staticClass:"main-body"},[i("SubPage",{attrs:{title:t.getTitle()}},[i("router-view")],1)],1),t._v(" "),i("div",{staticClass:"icp"},[i("a",{attrs:{href:"https://beian.miit.gov.cn",target:"_blank"}},[t._v(t._s(t.icp))])])]:i("router-view")],2)},staticRenderFns:[]};var y=i("VU/8")(g,b,!1,function(t){i("KcHc"),i("NABe")},"data-v-dbc10dfa",null).exports,_=i("/ocq"),w={name:"Login",methods:{login:function(){var t=this;this.form.userId&&this.form.password&&this.lib.requests.post({url:"/login",data:this.form,successMessage:!0,success:function(e){t.$router.push("/index")},error:function(){t.currStatus=4}})},toBotGitHub:function(){window.open("https://github.com/vivien8261/Amiya-Bot")},toConsoleGitHub:function(){window.open("https://github.com/vivien8261/Amiya-Bot-console")}},data:function(){return{form:{userId:"",password:""},status:{1:"normal",2:"account",3:"password",4:"error"},currStatus:1,icp:window.icp}}},x={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login"},[i("div",{staticClass:"rabbit"}),t._v(" "),i("div",{staticClass:"login-form"},[i("div",{staticClass:"github",on:{click:t.toConsoleGitHub}}),t._v(" "),i("div",{staticClass:"face",class:t.status[t.currStatus]}),t._v(" "),i("div",{staticClass:"logo"},[i("div",{staticClass:"text"},[t._v("Login")]),t._v(" "),i("div",{staticClass:"text bot",on:{click:t.toBotGitHub}},[t._v("Amiya-Bot")]),t._v(" "),i("div",{staticClass:"text"},[t._v("Console")])]),t._v(" "),i("div",{staticClass:"form"},[i("div",{staticClass:"form-title"},[t._v("UserID")]),t._v(" "),i("div",[i("el-input",{attrs:{size:"small",placeholder:"请输入用户ID","prefix-icon":"el-icon-user"},on:{focus:function(e){t.currStatus=2},blur:function(e){t.currStatus=1},change:t.login},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),t._v(" "),i("div",{staticClass:"form-title"},[t._v("Password")]),t._v(" "),i("div",[i("el-input",{attrs:{size:"small",type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-key"},on:{focus:function(e){t.currStatus=3},blur:function(e){t.currStatus=1},change:t.login},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),i("div",{staticClass:"form-button"},[i("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("Link Start !")])],1)])]),t._v(" "),i("div",{staticClass:"icp"},[i("a",{attrs:{href:"https://beian.miit.gov.cn",target:"_blank"}},[t._v(t._s(t.icp))])])])},staticRenderFns:[]};var k=i("VU/8")(w,x,!1,function(t){i("V47x")},"data-v-2ac23b54",null).exports,C={name:"NumberCard",props:{title:String,value:String|Number,color:String}},$={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"number-card",style:{backgroundColor:"#"+this.color}},[e("div",{staticClass:"value"},[this._v(this._s(this.value))]),this._v(" "),e("div",{staticClass:"title"},[this._t("default")],2)])},staticRenderFns:[]};var D=i("VU/8")(C,$,!1,function(t){i("uCiw")},"data-v-059e64bb",null).exports,S=i("XLwt"),F={name:"UserSignIn",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={grid:{top:"3%",left:"3%",right:"12%",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"value",splitLine:{show:!1}},yAxis:{type:"category",axisLabel:{color:"#333",fontWeight:"bold"},data:["签到用户"]},color:["#56d47d","#d7d7d7"],series:[{name:"已签到",type:"bar",stack:"count",data:[]},{name:"未签到",type:"bar",stack:"count",label:{show:!0,position:"right",formatter:"30%"},data:[]}]},e=this.data;t.series[0].data=[e[1]],t.series[1].data=[e[0]-e[1]],t.series[1].label.formatter=(e[1]/e[0]*100).toFixed(2)+"%",this.chart.setOption(t)},getUserSignData:function(){var t=this;this.lib.requests.post({url:"/dashboard/getUserSignRate",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:{0:0,1:0}}},mounted:function(){this.chart=S.b(this.$refs.chart),this.getUserSignData()}},A={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"user-sign-in"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var P={name:"MessageCount",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={title:{text:"消息数量分析"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},legend:{data:["群聊","主动呼叫","回复"]},axisPointer:{link:{xAxisIndex:"all"}},grid:[{left:"10%",right:"4%",height:"35%"},{top:"60%",left:"10%",right:"4%",height:"35%"}],xAxis:[{type:"category",boundaryGap:!1,axisLine:{onZero:!0},axisLabel:{show:!1},data:[]},{gridIndex:1,type:"category",boundaryGap:!1,axisLine:{onZero:!0},data:[],position:"top"}],yAxis:[{type:"value",offset:15},{type:"value",inverse:!0,gridIndex:1,offset:15}],color:["#5f75ed","#ffba31","#56d47d"],series:[{name:"群聊",type:"line",areaStyle:{opacity:.8,color:new S.a.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 221, 255)"},{offset:1,color:"rgba(77, 119, 255)"}])},label:{show:!0},data:[],smooth:!0},{name:"主动呼叫",type:"bar",barMaxWidth:10,stack:"count",xAxisIndex:1,yAxisIndex:1,data:[],smooth:!0},{name:"回复",type:"bar",barMaxWidth:10,stack:"count",xAxisIndex:1,yAxisIndex:1,label:{show:!0,position:"bottom"},data:[],smooth:!0}]},e=this.data;for(var i in e)t.xAxis[0].data.unshift(i),t.xAxis[1].data.unshift(i),t.series[0].data.unshift(e[i].talk),t.series[1].data.unshift(e[i].call),t.series[2].data.unshift(e[i].reply);this.chart.setOption(t)},getMessageAnalysis:function(){var t=this;this.lib.requests.post({url:"/dashboard/getMessageAnalysis",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:null}},mounted:function(){this.chart=S.b(this.$refs.chart),this.getMessageAnalysis()}},O={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message-count"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var U={name:"FunctionCount",watch:{data:{handler:function(){this.load()},deep:!0}},methods:{load:function(){var t={title:{text:"函数使用总量"},legend:{type:"scroll",orient:"vertical",top:40,left:0,bottom:20},tooltip:{trigger:"item"},series:{type:"pie",radius:["50%","80%"],center:["65%","50%"],itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,fontSize:"20",fontWeight:"bold",position:"center",formatter:"{b}\n\n{c}"},minAngle:10,data:[]}},e=this.data,i=!0,a=!1,s=void 0;try{for(var r,o=n()(e);!(i=(r=o.next()).done);i=!0){var l=r.value;t.series.data.push({name:l.function_id,value:l.use_num})}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}t.series.data.sort(function(t,e){return e.value-t.value}),t.series.data[0].selected=!0,t.series.data[0].label={show:!0},this.chart.setOption(t)},getFunctionUsed:function(){var t=this;this.lib.requests.post({url:"/dashboard/getFunctionUsed",success:function(e){t.$set(t,"data",e)}})}},data:function(){return{chart:null,data:null}},mounted:function(){this.chart=S.b(this.$refs.chart),this.getFunctionUsed()}},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"function-count"},[e("div",{ref:"chart"})])},staticRenderFns:[]};var B={name:"Dashboard",components:{NumberCard:D,UserSignIn:i("VU/8")(F,A,!1,function(t){i("jMcx")},"data-v-2f726472",null).exports,MessageCount:i("VU/8")(P,O,!1,function(t){i("VnSi")},"data-v-5d5dae47",null).exports,FunctionCount:i("VU/8")(U,I,!1,function(t){i("xIB9")},"data-v-11fc278c",null).exports},methods:{getTotalMessage:function(){var t=this;this.lib.requests.post({url:"/dashboard/getTotalMessage",success:function(e){t.cards.reply=e}})},getMessageSpeed:function(){var t=this;this.lib.requests.post({url:"/dashboard/getMessageSpeed",success:function(e){t.cards.speed=e}})},getActiveUsers:function(){var t=this;this.lib.requests.post({url:"/dashboard/getActiveUsers",success:function(e){t.cards.activeUsers=e}})}},data:function(){return{cards:{reply:0,activeUsers:0,speed:0}}},mounted:function(){this.getTotalMessage(),this.getMessageSpeed(),this.getActiveUsers()}},T={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dashboard"},[i("div",{staticClass:"information"},[i("number-card",{attrs:{value:t.cards.reply,color:"5f75ed"}},[[i("span",[t._v("24小时内")]),t._v(" "),i("span",[t._v("总回复次数")])]],2),t._v(" "),i("number-card",{attrs:{value:t.cards.activeUsers,color:"ff7ea8"}},[[i("span",[t._v("24小时内")]),t._v(" "),i("span",[t._v("活跃用户总数")])]],2),t._v(" "),i("number-card",{attrs:{value:t.cards.speed+"/min",color:"56d47d"}},[[i("span",[t._v("实时")]),t._v(" "),i("span",[t._v("消息接收速度")])]],2)],1),t._v(" "),i("div",{staticClass:"charts"},[i("div",{staticClass:"left-side"},[i("message-count"),t._v(" "),i("div",{staticClass:"seat seat-left-row2"})],1),t._v(" "),i("div",{staticClass:"right-side"},[i("function-count"),t._v(" "),i("div",{staticClass:"seat seat-right-row1-right"}),t._v(" "),i("user-sign-in"),t._v(" "),i("div",{staticClass:"seat seat-right-row2-right"}),t._v(" "),i("div",{staticClass:"seat seat-right-row3-bottom"})],1)])])},staticRenderFns:[]};var L=i("VU/8")(B,T,!1,function(t){i("ZL//")},"data-v-3c730fe8",null).exports,M=i("fZjL"),V=i.n(M),q={size:{type:String,default:"medium"},inline:{type:Boolean,default:!1},labelWidth:{type:String,default:"150px"},buildData:{type:Array,default:function(){return[]}},displayFilter:{type:Array,default:function(){return[]}},displayAll:{type:Boolean,default:!0},beforeSubmit:{type:Function,default:function(){return null}}},W={bind:Object,field:String,virtual:Object,setVirtual:Function,tree:{type:Object,default:function(){return{}}},treeData:{type:Array,default:function(){return[]}},selected:{type:Function,default:function(){}}},R={name:"eCheckboxTree",props:{data:Array,nodeKey:{type:String,default:"id"},label:{type:String,default:"label"},children:{type:String,default:"children"},nodeClick:{type:Function,default:function(t){return null}},height:{type:String,default:"500px"},expandAll:{type:Boolean,default:!0},checkbox:{type:Boolean,default:!1},expandOnClickNode:{type:Boolean,default:!0}},watch:{filterText:function(t){this.$refs.tree.filter(t)}},methods:{getCheckedNodes:function(){return this.$refs.tree.getCheckedNodes()},getCheckedKeys:function(){return this.$refs.tree.getCheckedKeys()},setCheckedKeys:function(t){this.$refs.tree.setCheckedKeys(t)},filterNode:function(t,e){return!t||-1!==e[this.label].indexOf(t)}},data:function(){return{defaultProps:{label:this.label,children:this.children},filterText:""}}},z={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:{height:t.height}},[i("el-form",{attrs:{size:"small","label-width":"0"}},[i("el-form-item",{staticStyle:{"margin-bottom":"0"}},[i("el-input",{attrs:{placeholder:"输入关键字搜索"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1)],1),t._v(" "),i("div",{staticClass:"treeCon"},[i("el-tree",{ref:"tree",attrs:{"highlight-current":"",data:t.data,"node-key":t.nodeKey,props:t.defaultProps,"show-checkbox":t.checkbox,"default-expand-all":t.expandAll,"expand-on-click-node":!1,"filter-node-method":t.filterNode},on:{"node-click":t.nodeClick}})],1)],1)},staticRenderFns:[]};var E={name:"treeSelector",props:W,components:{eCheckboxTree:i("VU/8")(R,z,!1,function(t){i("wxIg")},"data-v-50f9789a",null).exports},watch:{status:{handler:function(t){this.visible=t.onFocus||t.onHover},deep:!0},dataList:{handler:function(t){this.$emit("dataChange",t)},deep:!0}},methods:{uid:function(){return"treeSelector"+this._uid},show:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments[1];this.minWidth=e.target.clientWidth,this.status.onFocus=t},nodeSelected:function(t){if(t){if(this.field in t){var e=t[this.virtual&&"value"in this.virtual?this.virtual.value:this.field],i=t[this.virtual&&"show"in this.virtual?this.virtual.show:this.field];this.bind[this.field]=i||e,this.setVirtual(this.field,e)}this.selected&&this.selected(JSON.parse(d()(t)))}this.status.onHover=!1}},data:function(){return{visible:!1,status:{onFocus:!1,onHover:!1},minWidth:0}},mounted:function(){var t=this;h()("."+this.uid()).off("mouseenter mouseleave").on({mouseenter:function(){return t.status.onHover=!0},mouseleave:function(){return t.status.onHover=!1}})}},N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tree-selector"},[i("el-popover",{attrs:{placement:"bottom",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{attrs:{slot:"reference"},slot:"reference"},[t._t("default",null,{show:t.show})],2),t._v(" "),i("div",{staticClass:"tree-content",class:t.uid(),style:{minWidth:t.minWidth+"px"}},[i("e-checkbox-tree",{attrs:{data:t.treeData,"node-key":t.tree.id,label:t.tree.label,children:t.tree.children,"node-click":t.nodeSelected,"expand-on-click-node":!1,checkbox:!1}})],1)])],1)},staticRenderFns:[]};var H=i("VU/8")(E,N,!1,function(t){i("QF50")},"data-v-70d96b5c",null).exports;function j(t){var e={},i={};t.querySelectorAll("tr").forEach(function(t){t.querySelectorAll("td, th").forEach(function(t,a){var n=t.querySelector(".cell");if(n){var s=t.className.match(/mark_(\S+)/)[1],r=n.clientWidth<=400?n.clientWidth:400;s in e&&!(e[s]<r)||(e[s]=r),a in i&&!(i[a]<r)||(i[a]=r)}})});var a=0,n=t.clientWidth;for(var s in i)a+=i[s];return a<n?"operation"in e?{operation:e.operation}:{}:e}var G={name:"tableSelector",props:{tableData:Array,tableField:Array,search:Function,inputValue:String,bind:Object,field:String,virtual:Object,setVirtual:Function,selected:{type:Function,default:function(){}}},watch:{inputValue:function(t){t?this.doSearch(t):(this.$set(this,"dataList",[]),this.$emit("inputEmpty"))},status:{handler:function(t){this.visible=t.onFocus||t.onHover},deep:!0},tableData:{handler:function(){this.loadData()},deep:!0},dataList:{handler:function(t){var e=this;this.$nextTick(function(){e.$set(e,"colWidth",j(e.$refs.table.$el)),e.$emit("dataChange",t)})},deep:!0},visible:function(t){var e=this;t?(this.doSearch(this.inputValue||void 0),h()(".search-table."+this.uid()).off("mouseenter mouseleave").on({mouseenter:function(){return e.status.onHover=!0},mouseleave:function(){return e.status.onHover=!1}})):h()(".search-table."+this.uid()).off("mouseenter mouseleave")},currIndex:function(t){var e=(t-6)*h()(".search-table."+this.uid()+" .curr").height();h()(".search-table."+this.uid()+" .el-table__body-wrapper").scrollTop(e)}},methods:{uid:function(){return"tableSelector"+this._uid},onInput:function(){this.setVirtual(this.field,"")},doSearch:function(t){var e=this;this.search&&this.search(t,function(t){e.$set(e,"dataList",t)})},show:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments[1];this.minWidth=i.target.clientWidth,this.status.onFocus=e,e&&(this.currIndex=0,h()(i.target).off("keydown").on({keydown:function(e){switch(e.keyCode){case 13:t.dataList.length&&(t.selectedRow(t.dataList[t.currIndex]),t.status.onFocus=!1,i.target.blur());break;case 38:t.currIndex=t.currIndex-1>-1?t.currIndex-1:0;break;case 40:t.currIndex=t.currIndex+1<t.dataList.length?t.currIndex+1:t.dataList.length-1}}}))},hoverRow:function(t){return t.rowIndex===this.currIndex?"curr":""},selectedRow:function(t){if(t){if(this.field in t){var e=t[this.virtual&&"value"in this.virtual?this.virtual.value:this.field],i=t[this.virtual&&"show"in this.virtual?this.virtual.show:this.field];this.bind[this.field]=i||e,this.setVirtual(this.field,e)}this.selected&&this.selected(JSON.parse(d()(t)))}this.status.onHover=!1},loadData:function(){this.$set(this,"dataList",this.tableData||[])}},data:function(){return{visible:!1,status:{onFocus:!1,onHover:!1},dataList:[],colWidth:{},minWidth:0,currIndex:0}},mounted:function(){this.loadData()}},J={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table-selector"},[i("el-popover",{attrs:{placement:"bottom",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{attrs:{slot:"reference"},slot:"reference"},[t._t("default",null,{show:t.show,input:t.onInput})],2),t._v(" "),i("div",{staticClass:"search-table",class:t.uid(),style:{minWidth:t.minWidth+"px"}},[i("el-table",{ref:"table",attrs:{data:t.dataList,"row-class-name":t.hoverRow,"max-height":"303px",border:"","highlight-current-row":""},on:{"current-change":t.selectedRow}},t._l(t.tableField,function(e,a){return i("el-table-column",{key:a,attrs:{"class-name":"mark_"+e.field,width:(t.colWidth[e.field]||0)+"px",prop:e.field,label:e.title}})}),1)],1)])],1)},staticRenderFns:[]};var Z={name:"formBuilder",props:q,components:{treeSelector:H,tableSelector:i("VU/8")(G,J,!1,function(t){i("0kGW"),i("icDM")},null,null).exports},watch:{datePicker:{handler:function(){for(var t in this.datePicker){var e=this.datePicker[t];Array.isArray(e)?(this.formData[t][0]=e[0]?Math.ceil(new Date(e[0])/1e3):0,this.formData[t][1]=e[0]?Math.ceil(new Date(e[1])/1e3):0):this.formData[t]=e?Math.ceil(new Date(e)/1e3):0}},deep:!0}},methods:{uid:function(){return"formBuilder"+this._uid},init:function(){var t=this,e={},i={},a={},s={},r={},o={},l={},c={selected:{},change:{},input:{}},d=function(d){var u=t.buildData[d];if(!t.displayAll&&t.displayFilter.indexOf(u.title)<0&&t.displayFilter.indexOf(u.field)<0)return"continue";var f=function(){u.config.lazy?(r[u.field]=[31,32].indexOf(h)>=0?[]:{},u.config.data(function(t){return r[u.field]=t})):r[u.field]=u.config.data},h=u.config.type,p=u.config.default;u.field in t.formData&&void 0!==t.formData[u.field]&&""!==t.formData[u.field]&&(p=t.formData[u.field]);var m=1===h?"blur":"change";e[u.field]=[],u.config.required&&e[u.field].push({required:!0,message:u.title+"不能为空",trigger:m}),u.config.rule&&e[u.field].push({validator:function(t,e,i){var a=u.config.rule(e);if(a)return i(new Error(a)),!1;i()},trigger:m});var v=!!u.config.disabled;if(u.field in t.disabledItem&&t.disabledItem[u.field]&&(v=!0),l[u.field]=v,u.config.virtual&&(o[u.field]=(u.field in t.virtualData?t.virtualData[u.field]:p)||""),u.config.event){var g=!0,b=!1,y=void 0;try{for(var _,w=n()(V()(c));!(g=(_=w.next()).done);g=!0){var x=_.value;x in u.config.event&&(c[x][u.field]=u.config.event[x])}}catch(t){b=!0,y=t}finally{try{!g&&w.return&&w.return()}finally{if(b)throw y}}}switch(h){case 1:case 2:u.config.disabled||(i[d]={field:u.field,rule:u.config.rule,required:u.config.required}),a[u.field]=p||"";break;case 3:f(),u.config.multiple?a[u.field]=(p||[]).map(function(t){return t.toString()}):a[u.field]=(p||"").toString();break;case 31:case 32:f(),a[u.field]=p||"";break;case 4:case 41:s[u.field]=p?t.newData(p):"",a[u.field]=p||0;break;case 5:case 51:s[u.field]=p?[t.newData(p[0]),t.newData(p[1])]:["",""],a[u.field]=p||[0,0];break;case 6:case 7:f(),a[u.field]=7===h?(p||[]).map(function(t){return t.toString()}):(p||"").toString();break;case 8:a[u.field]=p||!1}};for(var u in this.buildData)d(u);this.$set(this,"rules",e),this.$set(this,"jumps",i),this.$set(this,"events",c),this.$set(this,"formData",a),this.$set(this,"datePicker",s),this.$set(this,"optionsData",r),this.$set(this,"virtualData",o),this.$set(this,"disabledItem",l),this.$nextTick(function(){h()("."+t.uid()+" .input-only").off("keydown").keydown(function(e){if(13===e.keyCode){var i=parseInt(h()(e.target).closest(".input-only")[0].className.match(/input-index-(\d+)/)[1]);t.autoJump(i)}}),t.reviewOptions()})},autoJump:function(t){var e=this.jumps[t],i=this.formData[e.field];if(""===i&&e.required)return!1;if(e.rule&&e.rule(i))return this.$refs[e.field][0].select(),!1;var a=V()(this.jumps).map(function(t){return parseInt(t)}),n=a[a.indexOf(t)+1],s=this.jumps[n];s?this.$refs[s.field][0].focus():this.beforeSubmit(this.formData)},formChange:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"change";t in this.events[i]&&this.events[i][t](JSON.parse(d()(e)))},setValue:function(t,e){var i=this;if(t.constructor===Object){for(var a in t)this.setValue(a,t[a]);return!1}var n=function(){t in i.virtualData?i.virtualData[t]=e:i.formData[t]=e};for(var s in this.buildData){var r=this.buildData[s];if(t===r.field){switch(r.config.type){case 3:e=Array.isArray(e)?e.map(function(t){return t.toString()}):e.toString(),n();break;case 31:n(),this.$refs["tableSelector"+s][0].doSearch(e);continue;case 4:case 41:this.datePicker[r.field]=e?this.newData(e):"";break;case 5:case 51:this.datePicker[r.field]=e?[this.newData(e[0]),this.newData(e[1])]:["",""];break;default:n()}this.reviewOptions(t);break}}},setOptions:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.$set(this.optionsData,t,e),i&&this.reviewOptions(t)},setDisabled:function(t,e){this.$set(this.disabledItem,t,e)},setVirtual:function(t,e){t in this.virtualData&&this.$set(this.virtualData,t,e)},reviewOptions:function(t){var e=this,i=function t(i,a){for(var n in i){var s=i[n];if(s[a.config.virtual.value||a.field]===e.virtualData[a.field])return e.formData[a.field]=s[a.config.virtual.show],!0;if("children"in s&&Array.isArray(s.children)&&s.children.length)if(t(s.children,a))return!0}},a=!0,s=!1,r=void 0;try{for(var o,l=n()(this.buildData);!(a=(o=l.next()).done);a=!0){var c=o.value,d=this.optionsData[c.field];d&&c.field in this.optionsData&&c.field in this.virtualData&&c.config.virtual&&"show"in c.config.virtual&&(!t||c.field===t)&&i(d,c)}}catch(t){s=!0,r=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw r}}},newData:function(t){return new Date(t*(t.toString().length<13?1e3:1))},cleanForm:function(t){var e=!0,i=!1,a=void 0;try{for(var s,r=n()(this.buildData);!(e=(s=r.next()).done);e=!0){var o=s.value;if(!t||t===o.field)switch(o.field in this.virtualData&&(this.virtualData[o.field]=""),o.config.type){case 3:o.config.multiple?this.formData[o.field]=[]:this.formData[o.field]="";break;case 4:case 41:this.datePicker[o.field]="";break;case 5:case 51:this.datePicker[o.field]=["",""];break;case 6:case 7:7===o.config.type?this.formData[o.field]=[]:this.formData[o.field]="";break;case 8:this.formData[o.field]=!1;break;default:this.formData[o.field]=""}}}catch(t){i=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw a}}}},data:function(){return{rules:{},jumps:[],formData:{},datePicker:{},optionsData:{},virtualData:{},disabledItem:{},datePickerType:{4:"date",41:"datetime",5:"daterange",51:"datetimerange"},events:{selected:{},change:{},input:{}}}}},Q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.uid()},[i("el-form",{staticClass:"formBuilder",attrs:{model:t.formData,rules:t.rules,size:t.size,inline:t.inline}},[t._l(t.buildData,function(e,a){return t.displayAll||t.displayFilter.indexOf(e.title)>=0||t.displayFilter.indexOf(e.field)>=0?i("el-form-item",{key:e.field,style:{display:e.config.block?"block":""},attrs:{prop:e.field,label:e.title,"label-width":t.labelWidth}},[1==e.config.type?i("el-input",{ref:e.field,refInFor:!0,staticClass:"input-only",class:"input-index-"+a,attrs:{placeholder:"请输入"+e.title,disabled:t.disabledItem[e.field],"suffix-icon":e.config.disabled?"el-icon-remove-outline":"el-icon-edit"},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])},input:function(i){return t.formChange(e.field,t.formData[e.field],"input")}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}}):t._e(),t._v(" "),2==e.config.type?i("el-input-number",{ref:e.field,refInFor:!0,staticClass:"input-only",class:"input-index-"+a,attrs:{placeholder:"请输入"+e.title,disabled:t.disabledItem[e.field],"controls-position":"right"},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])},input:function(i){return t.formChange(e.field,t.formData[e.field],"input")}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}}):t._e(),t._v(" "),3==e.config.type?i("el-select",{attrs:{clearable:"",multiple:e.config.multiple,"allow-create":e.config.create,filterable:e.config.create,"default-first-option":e.config.create,placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field]},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(t,e){return i("el-option",{key:e,attrs:{label:t,value:e}})}),1):t._e(),t._v(" "),31==e.config.type?i("table-selector",{ref:"tableSelector"+a,refInFor:!0,attrs:{"table-data":t.optionsData[e.field],"table-field":e.config.table.fields,search:e.config.table.search,"input-value":t.formData[e.field],virtual:e.config.virtual,field:e.field,bind:t.formData,selected:t.events.selected[e.field],setVirtual:t.setVirtual},on:{dataChange:function(i){return t.setOptions(e.field,i,!0)},inputEmpty:function(){return t.cleanForm(e.field)}},scopedSlots:t._u([{key:"default",fn:function(a){return[i("el-input",{ref:e.field,refInFor:!0,attrs:{placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field],readonly:"function"!=typeof e.config.table.search,"suffix-icon":"el-icon-caret-bottom"},on:{input:a.input,focus:function(t){return a.show(!0,t)},blur:function(t){return a.show(!1,t)},change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]}}],null,!0)}):t._e(),t._v(" "),32==e.config.type?i("tree-selector",{attrs:{tree:e.config.tree,"tree-data":t.optionsData[e.field],virtual:e.config.virtual,field:e.field,bind:t.formData,selected:t.events.selected[e.field],setVirtual:t.setVirtual},on:{dataChange:function(i){return t.setOptions(e.field,i,!0)}},scopedSlots:t._u([{key:"default",fn:function(a){return[i("el-input",{ref:e.field,refInFor:!0,staticClass:"tree-selector",attrs:{readonly:"",placeholder:"请选择"+e.title,disabled:t.disabledItem[e.field],"suffix-icon":"el-icon-caret-bottom"},on:{focus:function(t){return a.show(!0,t)},blur:function(t){return a.show(!1,t)},change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]}}],null,!0)}):t._e(),t._v(" "),e.config.type in t.datePickerType?i("el-date-picker",{attrs:{type:t.datePickerType[e.config.type],disabled:t.disabledItem[e.field],"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",placeholder:"请选择日期"},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.datePicker[e.field],callback:function(i){t.$set(t.datePicker,e.field,i)},expression:"datePicker[item.field]"}}):t._e(),t._v(" "),6==e.config.type?i("el-radio-group",{attrs:{disabled:t.disabledItem[e.field]},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(e,a){return i("el-radio",{key:a,attrs:{label:a}},[t._v(t._s(e)+"\n                ")])}),1):t._e(),t._v(" "),7==e.config.type?i("el-checkbox-group",{attrs:{disabled:t.disabledItem[e.field]},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},t._l(t.optionsData[e.field],function(e,a){return i("el-checkbox",{key:a,attrs:{label:a}},[t._v(t._s(e)+"\n                ")])}),1):t._e(),t._v(" "),8==e.config.type?i("el-switch",{attrs:{disabled:t.disabledItem[e.field],"active-color":"#5F75ED"},on:{change:function(i){return t.formChange(e.field,t.formData[e.field])}},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}}):t._e(),t._v(" "),e.config.tips?i("el-tooltip",{attrs:{content:e.config.tips,effect:"dark",placement:"top"}},[i("span",{staticClass:"el-icon-question"})]):t._e()],1):t._e()}),t._v(" "),i("el-form-item",{staticStyle:{display:"none"}},[i("el-input")],1)],2)],1)},staticRenderFns:[]};var K=i("VU/8")(Z,Q,!1,function(t){i("8Exs"),i("U4Bq")},"data-v-55d8f4e7",null).exports,X={name:"searchFormBuilder",components:{formBuilder:K},props:{searchForm:Array,searchFormDisplay:Array,searchOn:null|Boolean},watch:{searchOn:function(){this.calcSearchAreaHeight()},searchFormDisplay:function(){var t=this;this.$nextTick(function(){t.$refs.form.init(),t.calcSearchAreaHeight()})}},methods:{uid:function(){return"searchFormBuilder"+this._uid},calcSearchAreaHeight:function(){var t=this;setTimeout(function(){var e=h()("."+t.uid()+" "+(t.searchOn?".form":".searchData")).height();t.$emit("height",e),h()("."+t.uid()+".searchForm").css({height:e,padding:t.searchFormDisplay.length?"5px 0 10px":"0"})},0)},showText:function(t,e){var i=this.lib.common.formatDate,a=this.$refs.form.formData[t.field],n=t.config.type,s=t.field;if(s in this.$refs.form.formData){if(e)switch(n){case 3:return this.$refs.form.optionsData[s][a];case 4:case 41:return 3===n?i(a,"y-m-d"):i(a);case 5:case 51:return a.map(function(t){return 5===n?i(t,"y-m-d"):i(t)}).join(" 至 ");default:return a}switch(n){case 5:case 51:return!!a[0]&&!!a[1];default:return!!a}}return""},delSearch:function(t){this.$refs.form.cleanForm(t)},cleanForm:function(){this.$refs.form.cleanForm(),this.calcSearchAreaHeight()}}},Y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"searchForm",class:t.uid()},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.searchOn,expression:"searchOn"}],key:"1",staticClass:"form"},[i("formBuilder",{ref:"form",attrs:{size:"mini","label-width":"100px",inline:!0,"build-data":t.searchForm,"display-all":!1,"display-filter":t.searchFormDisplay}})],1)]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.searchOn&&null!=t.searchOn,expression:"!searchOn && searchOn != null"}],key:"2",staticClass:"searchData"},[i("el-alert",{attrs:{title:"搜索内容",type:"info",closable:!1}},t._l(t.searchForm,function(e,a){return t.showText(e,0)?i("div",{key:a,staticClass:"dataItem"},[i("span",[t._v(t._s(e.title))]),t._v(" "),i("span",[t._v(t._s(t.showText(e,1)))]),t._v(" "),i("span",{staticClass:"searchClose",on:{click:function(i){return t.delSearch(e.field)}}})]):t._e()}),0)],1)])],1)},staticRenderFns:[]};var tt=i("VU/8")(X,Y,!1,function(t){i("qQ8M"),i("e29U")},"data-v-e8acccb2",null).exports,et={name:"exportContent",props:["exportPageUrl","exportAllUrl","currPage","currPageSize","getValue"],methods:{exportData:function(t){var e=this.getValue();t&&(e.pageNum=this.currPage,e.pageSize=this.currPageSize),this.lib.requests.export({url:t?this.exportPageUrl:this.exportAllUrl,data:e},void 0,"xlsx")}}},it={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operations"},[i("el-button",{attrs:{size:"mini",type:"primary",plain:"",disabled:!t.exportPageUrl},on:{click:function(e){return t.exportData(!0)}}},[t._v("导出当前页\n    ")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger",plain:"",disabled:!t.exportAllUrl},on:{click:function(e){return t.exportData(!1)}}},[t._v("导出全部\n    ")])],1)},staticRenderFns:[]};var at=i("VU/8")(et,it,!1,function(t){i("TE5g")},"data-v-5d3763a1",null).exports,nt={name:"eTable",props:{fields:Array,dataId:String,totalPage:Number,exportPageUrl:String,exportAllUrl:String,operationMode:{type:Boolean,default:!0},selection:{type:Boolean,default:!0},pageSize:{type:Number,default:10},data:{type:Array,default:[]},sortable:{type:Boolean,default:!1},expandAll:{type:Boolean,default:!1},autoReset:{type:Boolean,default:!0},pagination:{type:Boolean,default:!0},listLoader:{type:Function,default:function(){return null}},expandLoader:{type:Function,default:function(){return null}}},components:{searchFormBuilder:tt,exportContent:at},computed:{tableChange:function(){return{data:this.data,display:this.display}}},watch:{tableChange:{handler:function(){this.resetWidth()},deep:!0}},methods:{uid:function(){return"table"+this._uid},rebuild:function(){var t=this;this.$nextTick(function(){var e=[],i=[],a=!0,s=!1,r=void 0;try{for(var o,l=n()(t.fields);!(a=(o=l.next()).done);a=!0){var c=o.value;e.push(c.title)}}catch(t){s=!0,r=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw r}}var d=!0,u=!1,f=void 0;try{for(var h,p=n()(t.display);!(d=(h=p.next()).done);d=!0){var m=h.value;e.indexOf(m)>=0&&i.push(m)}}catch(t){u=!0,f=t}finally{try{!d&&p.return&&p.return()}finally{if(u)throw f}}t.$set(t,"display",i),t.initSearchForm()})},getValue:function(){return this.$refs.searchForm.$refs.form.formData},setOptions:function(t,e){this.$refs.searchForm.$refs.form.setOptions(t,e)},searchList:function(){this.currPage=1,this.loadList()},loadList:function(){var t=this.getValue();this.listLoader(this.currPage,this.currPageSize,JSON.parse(d()(t)))},loadChildren:function(t,e,i){var a=this;this.expandLoader(t,function(t){i(t),a.resetWidth()})},calcTableHeight:function(t){var e=this.$refs.listTable.clientHeight;this.tableHeight=e-t-92},resetWidth:function(){var t=this;this.autoReset&&(this.loading=!0,this.$nextTick(function(){t.$set(t,"colWidth",j(t.$refs.table.$el)),t.$nextTick(function(){t.loading=!1})}))},pageChange:function(t){this.currPage=t,this.loadList()},pageSizeChange:function(t){this.currPageSize=t,this.loadList()},selectionChange:function(t){this.$set(this,"selectedItems",t)},initSearchForm:function(){var t=[],e=[],i=!0,a=!1,s=void 0;try{for(var r,o=n()(this.fields);!(i=(r=o.next()).done);i=!0){var l=r.value,c=l.search,d={title:l.title,field:l.field};!1!==c&&(d.config=c||{type:1},c&&!c.type&&(d.config.type=1),c&&"checked"in c&&c.checked&&e.push(l.title),t.push(d))}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}this.$set(this,"searchForm",t),this.$set(this,"searchFormDisplay",e),this.searchOn=!0},cleanForm:function(){this.$refs.searchForm.cleanForm(),this.loadList()}},data:function(){return{display:[],colWidth:{},selectedItems:[],searchForm:[],searchFormDisplay:[],searchOn:null,tableHeight:500,currPage:1,currPageSize:0,loading:!1}},mounted:function(){this.currPageSize=this.pageSize,this.initSearchForm()},updated:function(){h()("."+this.uid()+" .el-table__expand-icon").off("click").click(this.resetWidth)}},st={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"listTable",staticClass:"listTable",class:t.uid()},[i("searchFormBuilder",{ref:"searchForm",attrs:{"search-form":t.searchForm,"search-form-display":t.searchFormDisplay,"search-on":t.searchOn},on:{height:t.calcTableHeight}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.operationMode,expression:"operationMode"}],staticClass:"topArea"},[i("div",{staticClass:"tableOperation left"},[t._t("top"),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.searchList}},[t._v("查询")]),t._v(" "),i("el-button",{on:{click:t.cleanForm}},[t._v("重置查询")])],2),t._v(" "),i("div",{staticClass:"tableOperation right"},[i("el-popover",{attrs:{"popper-class":"operations",trigger:"click",title:"批量操作"}},[t.$scopedSlots.operations?i("div",{staticClass:"operations"},[t._t("operations",null,{items:t.selectedItems})],2):i("div",[t._v("无")]),t._v(" "),i("div",{staticClass:"tableButton operations",attrs:{slot:"reference"},slot:"reference"})]),t._v(" "),i("el-popover",{attrs:{"popper-class":"list",trigger:"click",title:"表头筛选"}},[i("el-form",{staticClass:"block"},[i("el-checkbox-group",{model:{value:t.display,callback:function(e){t.display=e},expression:"display"}},t._l(t.fields,function(t){return i("el-checkbox",{key:t.field,attrs:{label:t.title,name:t.field,checked:""}})}),1)],1),t._v(" "),i("div",{staticClass:"tableButton list",attrs:{slot:"reference"},slot:"reference"})],1),t._v(" "),i("div",{staticClass:"tableButton refresh",on:{click:t.loadList}}),t._v(" "),i("el-popover",{attrs:{"popper-class":"search",trigger:"click",title:"搜索项筛选"}},[i("el-form",{staticClass:"block"},[i("el-checkbox-group",{model:{value:t.searchFormDisplay,callback:function(e){t.searchFormDisplay=e},expression:"searchFormDisplay"}},t._l(t.searchForm,function(t,e){return i("el-checkbox",{key:e,attrs:{label:t.title,name:t.field}})}),1)],1),t._v(" "),i("div",{staticClass:"tableButton search",attrs:{slot:"reference"},slot:"reference"})],1),t._v(" "),i("div",{staticClass:"tableButton hide",class:{onHide:!t.searchOn},on:{click:function(e){t.searchOn=!t.searchOn}}}),t._v(" "),t.exportPageUrl||t.exportAllUrl?i("el-popover",{attrs:{"popper-class":"export",trigger:"click",title:"导出表单"}},[i("exportContent",{attrs:{"export-page-url":t.exportPageUrl,"export-all-url":t.exportAllUrl,"curr-page":t.currPage,"curr-page-size":t.currPageSize,"get-value":t.getValue}})],1):t._e()],1)]),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{border:"",lazy:"",data:t.data,"max-height":t.tableHeight,"row-key":t.dataId,load:t.loadChildren,"tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":t.expandAll},on:{"selection-change":t.selectionChange}},[t.selection?i("el-table-column",{attrs:{fixed:"left",type:"selection","class-name":"mark_selection"}}):t._e(),t._v(" "),t._l(t.fields,function(e,a){return t.display.indexOf(e.title)>=0?i("el-table-column",{key:a,attrs:{"class-name":"mark_"+e.field,width:t.colWidth[e.field],label:e.title,sortable:t.sortable},scopedSlots:t._u([{key:"default",fn:function(a){return[e.custom?t._t("custom",null,{field:e,item:a.row,value:a.row[e.field]}):i("span",[t._v(t._s(a.row[e.field]))])]}}],null,!0)}):t._e()}),t._v(" "),t.$scopedSlots.row?i("el-table-column",{attrs:{fixed:"right",label:"操作","class-name":"mark_operation",width:t.colWidth.operation},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("row",null,{item:e.row})]}}],null,!0)}):t._e()],2),t._v(" "),t.pagination?i("el-pagination",{staticClass:"page",attrs:{layout:"total, prev, pager, next, sizes, jumper",background:"","hide-on-single-page":!1,total:t.totalPage,"page-size":t.pageSize,"current-page":t.currPage},on:{"current-change":t.pageChange,"size-change":t.pageSizeChange}}):t._e()],1)},staticRenderFns:[]};var rt=i("VU/8")(nt,st,!1,function(t){i("UWDm"),i("zCt8"),i("gwtQ")},"data-v-322e18a1",null).exports,ot=[{title:"用户ID",field:"user_id",search:{type:1,checked:!0}},{title:"好感度",field:"user_feeling",search:!1},{title:"心情值",field:"user_mood",search:!1},{title:"累计对话数量",field:"message_num",search:!1},{title:"凭证数量",field:"coupon",search:!1},{title:"签到状态",field:"sign_in",custom:!0,search:{type:3,data:{0:"未签到",1:"已签到"},checked:!0}},{title:"累计签到次数",field:"sign_times",search:!1},{title:"黑名单状态",field:"black",custom:!0,search:{type:3,data:{0:"正常",1:"黑名单"},checked:!0}}],lt={name:"UserManager",components:{eTable:rt},methods:{loadUsers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/user/getUsersByPages",data:{page:t,pageSize:i,search:a},success:function(t){e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},setBlackUser:function(t,e){var i=this,a=e?"是否添加用户"+t.user_id+"至黑名单":"是否解除用户"+t.user_id+"的黑名单";this.lib.message.confirm(a,"注意",function(){i.lib.requests.post({url:"/user/setBlackUser",data:{user_id:t.user_id,black:e},successMessage:!0,success:function(t){i.$refs.table.loadList()}})})},sendCoupon:function(t){var e=this,i=[];if(Array.isArray(t)){if(!t.length)return void this.lib.message.alert("请至少选择一个用户");i=t.map(function(t){return t.user_id})}this.lib.message.prompt("输入发放数量","发放凭证",function(t){e.lib.requests.post({url:"/user/sendCoupon",data:{users:i,value:t},successMessage:!0,success:function(t){e.$refs.table.loadList()}})},"number")}},data:function(){return{table:{fields:ot,data:[],total:0}}},mounted:function(){this.loadUsers()}},ct={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shadow-box"},[i("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadUsers},scopedSlots:t._u([{key:"top",fn:function(){return[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.sendCoupon(null)}}},[t._v("全体发放凭证")])]},proxy:!0},{key:"operations",fn:function(e){var a=e.items;return[i("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.sendCoupon(a)}}},[t._v("发放凭证")])]}},{key:"custom",fn:function(e){var a=e.field,n=e.value;return["sign_in"===a.field?i("div",[n?i("span",{staticClass:"tag"},[t._v("已签到")]):i("span",[t._v("未签到")])]):t._e(),t._v(" "),"black"===a.field?i("div",[n?i("span",{staticClass:"tag black"},[t._v("黑名单")]):i("span",[t._v("正常")])]):t._e()]}},{key:"row",fn:function(e){var a=e.item;return[0===a.black?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setBlackUser(a,1)}}},[t._v("加入黑名单")]):t._e(),t._v(" "),1===a.black?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setBlackUser(a,0)}}},[t._v("解除黑名单")]):t._e()]}}])})],1)},staticRenderFns:[]};var dt=i("VU/8")(lt,ct,!1,function(t){i("Z+Wi")},"data-v-0a4150b9",null).exports,ut={name:"eForm",props:q,components:{formBuilder:K},methods:{getValue:function(t){var e=JSON.parse(d()(this.$refs.form.formData)),i=JSON.parse(d()(this.$refs.form.virtualData));for(var a in e)a in i&&(e[a]=i[a]),e[a].constructor===Boolean&&(e[a]=e[a]?1:0);return t&&t in e?e[t]:e},setValue:function(t,e){if(t.constructor===Object)for(var i in t)this.$refs.form.setValue(i,null!==t[i]&&void 0!==t[i]?t[i]:"");else this.$refs.form.setValue(t,null!==e&&void 0!==e?e:"")},setOptions:function(t,e){if(t.constructor===Object)for(var i in t)this.$refs.form.setOptions(i,t[i]);else this.$refs.form.setOptions(t,e)},setDisabled:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.constructor===Array){var i=!0,a=!1,s=void 0;try{for(var r,o=n()(t);!(i=(r=o.next()).done);i=!0){var l=r.value;this.$refs.form.setDisabled(l,e)}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}}else this.$refs.form.setDisabled(t,e)},cleanForm:function(t){if(t&&t.constructor===Array){var e=!0,i=!1,a=void 0;try{for(var s,r=n()(t);!(e=(s=r.next()).done);e=!0){var o=s.value;this.$refs.form.cleanForm(o)}}catch(t){i=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw a}}}else this.$refs.form.cleanForm(t)},reset:function(){this.$set(this.$refs.form,"formData",{}),this.$refs.form.init()}},mounted:function(){this.$forceUpdate()},updated:function(){this.$refs.form.init()}},ft={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"eForm"},[i("formBuilder",{ref:"form",attrs:{size:t.size,inline:t.inline,"label-width":t.labelWidth,"build-data":t.buildData,"display-filter":t.displayFilter,"display-all":t.displayAll,"before-submit":t.beforeSubmit}}),t._v(" "),i("el-form",{staticClass:"formBuilder"},[t._t("item"),t._v(" "),i("el-form-item",{attrs:{label:" ","label-width":t.labelWidth}},[t._t("default")],2)],2)],1)},staticRenderFns:[]};var ht=i("VU/8")(ut,ft,!1,function(t){i("q2Hs")},null,null).exports,pt={0:"普通卡池",1:"限定卡池",2:"联合寻访"},mt={0:"可抽取-限定干员",1:"可抽取-联动干员",2:"不可抽取-非常规途径",3:"不可抽取-销售",4:"不可抽取-公开招募",5:"不可抽取-活动奖励",6:"不可抽取-联动奖励",7:"不可抽取-危机合约奖励",8:"不可抽取-roguelike限定"},vt=[{title:"卡池名称",field:"pool_name",search:{type:1,checked:!0}},{title:"6星UP干员",field:"pickup_6",custom:!0,search:{type:1}},{title:"5星UP干员",field:"pickup_5",custom:!0,search:{type:1}},{title:"4星UP干员",field:"pickup_4",custom:!0,search:{type:1}},{title:"权值",field:"pickup_s",custom:!0,search:{type:1}},{title:"卡池属性",field:"limit_pool",custom:!0,search:{type:3,data:pt,checked:!0}}],gt=[{title:"卡池名称",field:"pool_name",config:{type:1}},{title:"6星UP干员",field:"pickup_6",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"5星UP干员",field:"pickup_5",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"4星UP干员",field:"pickup_4",config:{type:3,multiple:!0,create:!0,checked:!0}},{title:"权值",field:"pickup_s",config:{type:1}},{title:"卡池属性",field:"limit_pool",config:{type:3,data:pt,default:0}}],bt=[{title:"非常规获得的干员",field:"operator_name",search:{type:1,checked:!0}},{title:"属性",field:"operator_type",custom:!0,search:{type:3,data:mt,checked:!0}}],yt=[{title:"ID",field:"conf_id",config:{type:1,disabled:!0}},{title:"非常规获得的干员",field:"operator_name",config:{type:1}},{title:"属性",field:"operator_type",config:{type:3,data:mt,default:0}}],_t={name:"GachaConfig",components:{eWindow:v,eTable:rt,eForm:ht},methods:{loadConfig:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/operator/getOperatorGachaConfig",data:{page:t,pageSize:i,search:a},success:function(t){e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},windowOpen:function(t){this.$refs.window.show(),this.$nextTick(function(){t&&t()})},customConfig:function(t,e){var i=this;this.form.type=e,this.windowOpen(function(){e?i.$refs.form.setValue(t):i.$refs.form.cleanForm()})},delConfig:function(t){var e=this;this.lib.message.confirm("确定删除该干员配置吗？","请确认",function(){e.lib.requests.post({url:"/operator/delConfig",data:t,successMessage:!0,success:function(t){e.$refs.table.loadList()}})})},submitManage:function(){var t=this,e=this.$refs.form.getValue(),i=1===this.form.type?"/operator/editConfig":"/operator/addNewConfig";""!==e.operator_name?this.lib.requests.post({url:i,data:e,successMessage:!0,success:function(e){t.$refs.window.hide(),t.form.type?t.$refs.table.loadList():t.loadConfig()}}):this.lib.message.toast("干员名称不能为空","error")}},data:function(){return{table:{fields:bt,data:[],total:0},form:{fields:yt,type:0},operatorType:mt}},mounted:function(){this.loadConfig()}},wt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shadow-box"},[i("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadConfig},scopedSlots:t._u([{key:"top",fn:function(){return[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.customConfig(null,0)}}},[t._v("新增干员")])]},proxy:!0},{key:"custom",fn:function(e){var a=e.field,n=e.value;return["operator_type"===a.field?i("div",[t._v(t._s(t.operatorType[n]))]):t._e()]}},{key:"row",fn:function(e){var a=e.item;return[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.customConfig(a,1)}}},[t._v("修改")]),t._v(" "),i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delConfig(a)}}},[t._v("删除")])]}}])}),t._v(" "),i("e-window",{ref:"window",attrs:{title:(1===t.form.type?"修改":"新增")+"干员"}},[i("eForm",{ref:"form",attrs:{"build-data":t.form.fields}},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitManage()}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var xt=i("VU/8")(_t,wt,!1,function(t){i("4ACZ")},"data-v-1d65ce60",null).exports,kt=i("bOdI"),Ct=i.n(kt),$t={name:"GachaPool",components:{eWindow:v,eTable:rt,eForm:ht},methods:{loadPool:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/pool/getPoolsByPages",data:{page:t,pageSize:i,search:a},success:function(t){var i=!0,a=!1,s=void 0;try{for(var r,o=n()(t.data);!(i=(r=o.next()).done);i=!0)for(var l=r.value,c=["pickup_6","pickup_5","pickup_4"],d=0;d<c.length;d++){var u=c[d];l[u]=l[u]?l[u].split(","):[]}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},getAllOperator:function(){var t=this;this.lib.requests.post({url:"/operator/getAllOperator",success:function(e){var i={},a=!0,s=!1,r=void 0;try{for(var o,l=n()(e);!(a=(o=l.next()).done);a=!0){var c=o.value,d=c.rarity,u=c.name;d in i?i[d][u]=u:i[d]=Ct()({},u,u)}}catch(t){s=!0,r=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw r}}t.$set(t,"operators",i)}})},windowOpen:function(t){var e=this;this.$refs.window.show(),this.$nextTick(function(){e.$refs.form.setOptions({pickup_6:e.operators[6],pickup_5:e.operators[5],pickup_4:e.operators[4]}),t&&t()})},customPool:function(t,e){var i=this;this.form.type=e,this.windowOpen(function(){e?i.$refs.form.setValue(t):i.$refs.form.cleanForm(),i.$refs.form.setDisabled("pool_name",1===e)})},delPool:function(t){var e=this;this.lib.message.confirm("确定删除卡池【"+t.pool_name+"】吗？","请确认",function(){e.lib.requests.post({url:"/pool/delPool",data:t,successMessage:!0,success:function(t){e.$refs.table.loadList()}})})},submitManage:function(){var t=this,e=this.$refs.form.getValue(),i=1===this.form.type?"/pool/editPool":"/pool/addNewPool";e.pickup_6=e.pickup_6.join(","),e.pickup_5=e.pickup_5.join(","),e.pickup_4=e.pickup_4.join(","),""!==e.pool_name?this.lib.requests.post({url:i,data:e,successMessage:!0,success:function(e){t.$refs.window.hide(),t.form.type?t.$refs.table.loadList():t.loadPool()}}):this.lib.message.toast("卡池名称不能为空","error")}},data:function(){return{table:{fields:vt,data:[],total:0},form:{fields:gt,type:0},operators:{}}},mounted:function(){this.loadPool(),this.getAllOperator()}},Dt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shadow-box"},[i("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadPool},scopedSlots:t._u([{key:"top",fn:function(){return[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.customPool(null,0)}}},[t._v("新增卡池")])]},proxy:!0},{key:"custom",fn:function(e){var a=e.field,n=e.value;return["limit_pool"===a.field?i("div",[0===n?i("span",[t._v("普通卡池")]):t._e(),t._v(" "),1===n?i("span",{staticClass:"tag tag1"},[t._v("限定卡池")]):t._e(),t._v(" "),2===n?i("span",{staticClass:"tag tag2"},[t._v("联合寻访")]):t._e()]):t._e(),t._v(" "),["pickup_6","pickup_5","pickup_4"].indexOf(a.field)>=0?i("div",t._l(n,function(e,a){return i("span",{key:a,staticClass:"tag"},[t._v(t._s(e))])}),0):t._e(),t._v(" "),"pickup_s"===a.field?i("div",t._l(n,function(e,a){return i("span",{key:a,staticClass:"tag"},[t._v(t._s(e.replace("|"," X ")))])}),0):t._e()]}},{key:"row",fn:function(e){var a=e.item;return[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.customPool(a,1)}}},[t._v("修改")]),t._v(" "),i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delPool(a)}}},[t._v("删除")])]}}])}),t._v(" "),i("e-window",{ref:"window",attrs:{title:(1===t.form.type?"修改":"新增")+"卡池"}},[i("eForm",{ref:"form",attrs:{"build-data":t.form.fields}},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitManage()}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var St={name:"GachaManager",components:{GachaConfig:xt,GachaPool:i("VU/8")($t,Dt,!1,function(t){i("S0ZN")},"data-v-18fc4f8d",null).exports},data:function(){return{side:"left"}}},Ft={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"gacha-manager"},[i("div",[i("el-tabs",{model:{value:t.side,callback:function(e){t.side=e},expression:"side"}},[i("el-tab-pane",{attrs:{label:"卡池管理",name:"left"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"卡池干员管理",name:"right"}})],1)],1),t._v(" "),i("div",{staticClass:"container",class:t.side},[i("div",{staticClass:"block"},[i("GachaPool")],1),t._v(" "),i("div",{staticClass:"block"},[i("GachaConfig")],1)])])},staticRenderFns:[]};var At=i("VU/8")(St,Ft,!1,function(t){i("y1kf")},"data-v-fe079b92",null).exports,Pt={name:"AdminList",components:{eWindow:v,eTable:rt,eForm:ht},methods:{loadAdmin:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/admin/getAdminsByPages",data:{page:t,pageSize:i,search:a},success:function(t){var i=!0,a=!1,s=void 0;try{for(var r,o=n()(t.data);!(i=(r=o.next()).done);i=!0){var l=r.value;l.last_login=e.lib.common.formatDate(l.last_login)}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})},addAdmin:function(){var t=this;this.lib.message.prompt("请输入要注册的管理员ID","注册管理员",function(e){t.lib.requests.post({url:"/admin/registerAdmin",data:{user_id:e},successMessage:!0,success:function(e){t.$refs.table.loadList()}})})},setActive:function(t,e){var i=this;this.lib.requests.post({url:"/admin/setActive",data:{user_id:t.user_id,active:e},successMessage:!0,success:function(t){i.$refs.table.loadList()}})},delAdmin:function(t){var e=this;this.lib.message.confirm("确定删除管理员【"+t.user_id+"】吗？将同步删除该管理员的行为记录","请确认",function(){e.lib.requests.post({url:"/admin/delAdmin",data:{user_id:t.user_id},successMessage:!0,success:function(t){e.$refs.table.loadList()}})})}},data:function(){return{table:{fields:[{title:"账户名",field:"user_id",search:{type:1,checked:!0}},{title:"密码",field:"password",search:!1},{title:"最后登录时间",field:"last_login",search:!1},{title:"最后登录IP地址",field:"last_login_ip",search:!1},{title:"是否启用",field:"active",custom:!0,search:{type:3,data:{0:"启用",1:"禁用"},checked:!0}}],data:[],total:0}}},mounted:function(){this.loadAdmin()}},Ot={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shadow-box"},[i("e-table",{ref:"table",attrs:{fields:t.table.fields,data:t.table.data,"total-page":t.table.total,"list-loader":t.loadAdmin},scopedSlots:t._u([{key:"top",fn:function(){return[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addAdmin(null,0)}}},[t._v("注册管理员")])]},proxy:!0},{key:"custom",fn:function(e){var a=e.field,n=e.value;return["active"===a.field?i("div",[n?i("span",{staticClass:"tag"},[t._v("已启用")]):i("span",[t._v("未启用")])]):t._e()]}},{key:"row",fn:function(e){var a=e.item;return[1===a.active?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setActive(a,0)}}},[t._v("禁用")]):t._e(),t._v(" "),0===a.active?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.setActive(a,1)}}},[t._v("启用")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.delAdmin(a)}}},[t._v("删除")])]}}])})],1)},staticRenderFns:[]};var Ut={name:"AdminList",components:{eWindow:v,eTable:rt,eForm:ht},methods:{loadAdminTrace:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.lib.requests.post({url:"/admin/getAdminTraceByPages",data:{page:t,pageSize:i,search:a},success:function(t){var i=!0,a=!1,s=void 0;try{for(var r,o=n()(t.data);!(i=(r=o.next()).done);i=!0){var l=r.value;l.time=e.lib.common.formatDate(l.time)}}catch(t){a=!0,s=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw s}}e.$set(e.table,"data",t.data),e.$set(e.table,"total",t.count)}})}},data:function(){return{table:{fields:[{title:"账户名",field:"user_id",search:{type:1,checked:!0}},{title:"调用接口",field:"interface",search:{type:1,checked:!0}},{title:"JSON参数",field:"params",search:!1},{title:"时间",field:"time",search:!1}],data:[],total:0}}},mounted:function(){this.loadAdminTrace()}},It={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"shadow-box"},[e("e-table",{ref:"table",attrs:{fields:this.table.fields,data:this.table.data,"total-page":this.table.total,"list-loader":this.loadAdminTrace}})],1)},staticRenderFns:[]};var Bt={name:"AdminManager",components:{AdminList:i("VU/8")(Pt,Ot,!1,function(t){i("7OpQ")},"data-v-e62e3652",null).exports,AdminTraceLog:i("VU/8")(Ut,It,!1,function(t){i("qtFq")},"data-v-8a2a6dfa",null).exports},data:function(){return{side:"left"}}},Tt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"admin-manager"},[i("div",[i("el-tabs",{model:{value:t.side,callback:function(e){t.side=e},expression:"side"}},[i("el-tab-pane",{attrs:{label:"管理员列表",name:"left"}}),t._v(" "),i("el-tab-pane",{attrs:{label:"管理员行为记录",name:"right"}})],1)],1),t._v(" "),i("div",{staticClass:"container",class:t.side},[i("div",{staticClass:"block"},[i("AdminList")],1),t._v(" "),i("div",{staticClass:"block"},[i("AdminTraceLog")],1)])])},staticRenderFns:[]};var Lt=i("VU/8")(Bt,Tt,!1,function(t){i("luHS")},"data-v-867451b6",null).exports;s.default.use(_.a);var Mt=new _.a({routes:[{path:"/",name:"Login",component:k},{path:"/index",name:"Dashboard",component:L},{path:"/user",name:"UserManager",component:dt},{path:"/gacha",name:"GachaManager",component:At},{path:"/trace",name:"AdminManager",component:Lt}]}),Vt=i("pFYg"),qt=i.n(Vt),Wt=i("Zrlr"),Rt=i.n(Wt),zt=i("wxAW"),Et=i.n(zt),Nt=function(){function t(){Rt()(this,t)}return Et()(t,[{key:"saveData",value:function(t,e){var i=null;"object"===(void 0===e?"undefined":qt()(e))&&(i=d()(e)),"string"!=typeof e&&"number"!=typeof e||(i=e.toString()),i&&localStorage.setItem(t,i)}},{key:"getData",value:function(t){var e=localStorage.getItem(t);if(e){try{e=JSON.parse(e)}catch(t){}return e}}},{key:"removeData",value:function(t){localStorage.removeItem(t)}},{key:"formatDate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y-m-d h:i:s";if(t){var i=t*(t.toString().length<13?1e3:1),a=new Date(i),n=function(t){return parseInt(t)<10?"0"+t:t},s={y:a.getFullYear(),m:n(a.getMonth()+1),d:n(a.getDate()),h:n(a.getHours()),i:n(a.getMinutes()),s:n(a.getSeconds())};for(var r in s)e=e.replace(new RegExp(r,"g"),s[r]);return e}return t}}]),t}(),Ht=i("mtWM"),jt=i.n(Ht),Gt=i("zL8q"),Jt=i.n(Gt),Zt=function(){function t(){Rt()(this,t),this.info="info",this.error="error",this.success="success",this.warning="warning"}return Et()(t,[{key:"toast",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.success;Object(Gt.Message)({type:e,message:t})}},{key:"notify",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.info,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;Object(Gt.Notification)({type:i,title:e,message:t,duration:a})}},{key:"alert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",i=arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.info;Gt.MessageBox.alert(t,e,{type:a,confirmButtonText:"好的",callback:i}).then(null)}},{key:"confirm",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",i=arguments[2],a=arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.warning;Gt.MessageBox.confirm(t,e,{type:n,confirmButtonText:"确定",cancelButtonText:"取消"}).then(i||null).catch(a||null)}},{key:"prompt",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"提示",i=arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";Gt.MessageBox.prompt(t,e,{confirmButtonText:"确定",cancelButtonText:"取消",inputType:a}).then(function(t){i&&i(t.value)})}}]),t}();window.axiosRequestsList=[],jt.a.defaults.withCredentials=!0;var Qt,Kt=function(){function t(e){Rt()(this,t),this.host=e.host,this.message=new Zt}return Et()(t,[{key:"httpRequests",value:function(t,e){var i=this;try{var a=e.url,n=e.data||{},s=void 0!==e.successMessage&&e.successMessage,r=e.success,o=e.error,l=e.complete,c=["PUT","POST","PATCH"].indexOf(t.toUpperCase())>=0,u=c?"data":"params",f=c?d()(n):n,h=Ct()({url:"http://"+this.host+a,method:t,headers:{"Content-Type":"application/json"},cancelToken:new jt.a.CancelToken(function(t){window.axiosRequestsList.push({cancel:t})})},u,f),p=Gt.Loading.service({lock:!0,text:"请求中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.3)"});jt()(h).then(function(t){var e=t.data;if(200===t.status){var a=e.code,n=e.message;switch(a){case 200:s&&n&&s&&i.message.toast(n,i.message.success),r&&r(e.data);break;case 400:i.message.alert(n,"Access 错误",function(){location.href="/"});break;case 0:i.message.notify(n,"提示",i.message.warning),o&&o()}}}).catch(function(t){i.message.notify(t.toString(),"请求发生错误",i.message.error)}).finally(function(){p.close(),l&&l()})}catch(o){throw o}}},{key:"get",value:function(t){this.httpRequests("get",t)}},{key:"post",value:function(t){this.httpRequests("post",t)}}]),t}();i("tvR6");s.default.use(Jt.a),s.default.config.productionTip=!1,s.default.prototype.lib=(Qt={host:location.host},{common:new Nt,requests:new Kt(Qt),message:new Zt}),Mt.beforeEach(function(t,e,i){var a=!0,s=!1,r=void 0;try{for(var o,l=n()(window.axiosRequestsList);!(a=(o=l.next()).done);a=!0){o.value.cancel()}}catch(t){s=!0,r=t}finally{try{!a&&l.return&&l.return()}finally{if(s)throw r}}window.axiosRequestsList=[],i()}),new s.default({el:"#app",router:Mt,components:{App:y},template:"<App/>"})},QF50:function(t,e){},S0ZN:function(t,e){},TE5g:function(t,e){},U4Bq:function(t,e){},UWDm:function(t,e){},V47x:function(t,e){},VnSi:function(t,e){},"Z+Wi":function(t,e){},"ZL//":function(t,e){},aSaL:function(t,e){},e29U:function(t,e){},gwtQ:function(t,e){},icDM:function(t,e){},jMcx:function(t,e){},luHS:function(t,e){},"pE/J":function(t,e){},q2Hs:function(t,e){},qQ8M:function(t,e){},qtFq:function(t,e){},tvR6:function(t,e){},uCiw:function(t,e){},wxIg:function(t,e){},xIB9:function(t,e){},y1kf:function(t,e){},zCt8:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.20b80847c6e7bc9c0fea.js.map